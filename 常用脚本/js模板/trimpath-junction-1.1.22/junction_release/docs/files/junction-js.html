<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><title>TrimPath.junction</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script></head><body class=UnframedPage onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.35 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->

<table border=0 cellspacing=0 cellpadding=0 width=100%><tr><td class=MenuSection valign=top><!--START_ND_MENU--><div class=MEntry><div class=MFile><a href="junction_doc_about-txt.html">About TrimPath Junction</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_run-txt.html">Runtime Environments</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_run_browser-txt.html">Runtime In The Browser</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_run_server-txt.html">Runtime On The Server</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_sync-txt.html">Synchronization</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_translation-txt.html">Translations</a></div></div><div class=MEntry><div class=MFile id=MSelected>TrimPath.<span class=HB> </span>junction</div></div><div class=MEntry><div class=MFile><a href="junctionClient-js.html">TrimPath.<span class=HB> </span>junctionClient</a></div></div><div class=MEntry><div class=MFile><a href="junctionHelpers-js.html">TrimPath.<span class=HB> </span>junctionHelpers</a></div></div><div class=MEntry><div class=MFile><a href="junctionUtil-js.html">TrimPath.<span class=HB> </span>junctionUtil</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_controller-txt.html">web-MVC Controller</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_model-txt.html">web-MVC Model</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_view-txt.html">web-MVC View</a></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Index</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MIndex><a href="../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Classes.html">Classes</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Variables.html">Variables</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Properties.html">Properties</a></div></div></div></div></div><!--END_ND_MENU--></td>

<td class=ContentSection valign=top><div class=CClass id=MainTopic><div class=CTopic><h1 class=CTitle><a name="TrimPath.junction"></a>TrimPath.<span class=HB> </span>junction</h1><div class=CBody><h4 class=CHeading>Source</h4><p class=CParagraph>trimpath/junction.js</p><h4 class=CHeading>Release</h4><p class=CParagraph>1.1.22</p><h4 class=CHeading>Copyright</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>copyright &copy; 2005</td><td class=CDLDescription>2008 Steve Yen, TrimPath.</td></tr></table><h4 class=CHeading>License</h4><p class=CParagraph>dual licensed GNU General Public License 2.0 and Apache Public License 2.0</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SMain><div class=SEntry><a href="#TrimPath.junction" >TrimPath.<span class=HB> </span>junction</a></div></div></td><td class=SDescriptionSize><div class=SMain><div class=SDescription>trimpath/junction.js</div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#TrimPath.junction.Variables" >Variables</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SVariable><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.env" >env</a></div></div></div></td><td><div class=SVariable><div class=SDescription><div class=SIndent2>The env object provides a runtime-environment-specific collection of functions and information that the Junction system requires to work.</div></div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#TrimPath.junction.Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.syncUp" id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">syncUp ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Requests an asynchronous synchronization of the local database with the server database. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.isOnline" id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">isOnline ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns whether a client-side Junction environment is online (has connectivity to a server). </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.dbExecute(sql,optParams)" id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">dbExecute (sql, optParams)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Executes a SQL query against the local application database. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.scaffold(controllerFunc,modelName)" id=link4 onMouseOver="ShowTip(event, 'tt4', 'link4')" onMouseOut="HideTip('tt4')">scaffold (controllerFunc, modelName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Provides some simple Controller action methods for a given Model for increased developer productivity.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.beforeFilter(controllerFunc,filterFunc)" >beforeFilter (controllerFunc, filterFunc)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Appends a filter function to the &lsquo;before&rsquo; filter chain of a Controller. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.modelFor(modelName,func)" >modelFor (modelName, func)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the modelInit function. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#TrimPath.junction.modelInit(modelName,func)" >modelInit (modelName, func)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Tells the Junction system that a given function/constructor represents a Model object. </div></div></div></td></tr><tr><td><div class=SSection><div class=SEntry><a href="#Model_Documentation" >Model Documentation</a></div></div></td><td><div class=SSection><div class=SDescription>Junction follows the &lsquo;Active Record&rsquo; design pattern for object-relational mapping. </div></div></td></tr><tr><td><div class=SClass><div class=SEntry><a href="#Model" >Model</a></div></div></td><td><div class=SClass><div class=SDescription>A Model class represents and manages a tables in a database. </div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#Model.Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.find" id=link5 onMouseOver="ShowTip(event, 'tt5', 'link5')" onMouseOut="HideTip('tt5')">find ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Queries the database for records of Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.findActive(id,params)" >findActive (id, params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Like find(), but ensures that &lsquo;active = 1&rsquo; is part of the query.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.findAll(params)" >findAll (params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Equivalent to Model.find(&lsquo;all&rsquo;, params).</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.findFirst(params)" >findFirst (params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Equivalent to Model.find(&lsquo;first&rsquo;, params)</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.findBySql(sql)" >findBySql (sql)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Queries the database for Model instances using a full SQL query string.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.countActive(params)" >countActive (params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Does a SELECT COUNT(*) query for active records.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.newInstance(attrs)" >newInstance (attrs)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Creates a new, unsaved instance of a Model.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.new_instance(attrs)" >new_instance (attrs)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for Model.newInstance(attrs)</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.build(attrs)" >build (attrs)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for Model.newInstance(attrs). </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.isNewRecord" >isNewRecord ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns true if the record is a new, unsaved record.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.isNewInstance" >isNewInstance ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the isNewRecord() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.is_new_instance" >is_new_instance ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the isNewRecord() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.is_new_record" >is_new_record ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the isNewRecord() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.deactivate" id=link6 onMouseOver="ShowTip(event, 'tt6', 'link6')" onMouseOut="HideTip('tt6')">deactivate ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sets the active column of the model instance to 0. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.destroy" id=link7 onMouseOver="ShowTip(event, 'tt7', 'link7')" onMouseOut="HideTip('tt7')">destroy ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Deletes the model record from the local RDBMS. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.save" id=link8 onMouseOver="ShowTip(event, 'tt8', 'link8')" onMouseOut="HideTip('tt8')">save ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Saves a new or updated Model instance to the RDBMS.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.isValid" >isValid ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Runs the validations on the model instance. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.valid" >valid ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the isValid() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.is_valid" >is_valid ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the isValid() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.errors" id=link9 onMouseOver="ShowTip(event, 'tt9', 'link9')" onMouseOut="HideTip('tt9')">errors ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns the ModelErrors object that holds validation error information.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.updateAttributes" >updateAttributes ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Updates several attributes of the modelInstance and saves. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.update_attributes" >update_attributes ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the updateAttributes() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.setConventionalAttributes(...)" id=link10 onMouseOver="ShowTip(event, 'tt10', 'link10')" onMouseOut="HideTip('tt10')">setConventionalAttributes (...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sets the convention-over-configuration field attributes of the Model instance. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#Model.onBeforeSync" >onBeforeSync ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An optional callback function that&rsquo;s called before client-side synchronization.</div></div></div></td></tr><tr><td><div class=SSection><div class=SEntry><a href="#Model_Metadata" >Model Metadata</a></div></div></td><td><div class=SSection><div class=SDescription>The metadata for a Model defines the object-relational mapping between the JavaScript Model object and a database table in the RDBMS. </div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#tableName(tableNameVal)" >tableName (tableNameVal)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Tells junction the name of the table in the database that maps to the Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#pluralName(pluralNameVal)" >pluralName (pluralNameVal)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Tells junction the plural name of the Model. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#hasMany(childPluralName,info)" >hasMany (childPluralName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Associates a Model (a &lsquo;parent&rsquo;) in a has-many relationship with a &lsquo;child&rsquo; Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#hasManyActive(childPluralName,info)" >hasManyActive (childPluralName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Similar to hasMany(), but uses findActive() instead of find() for the generated child getter function. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#belongsTo(parentName,info)" >belongsTo (parentName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Associates a child Model with a parent Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#belongsToActive(parentName,info)" >belongsToActive (parentName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Similar to belongsTo(), but uses findActive() instead of find for the generated parent getter function. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#validatesFormatOf(attrName,regexp,msg,on)" >validatesFormatOf (attrName, regexp, msg, on)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds a field/column validation rule based on a regular expression.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#validatesInclusionOf(attrName,inArray,msg,on)" >validatesInclusionOf (attrName, inArray, msg, on)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds a field/column validation rule based an array of allowed values.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#validatesPresenceOf(attrName,msg,on)" >validatesPresenceOf (attrName, msg, on)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds a field/column validation rule checking for non-null.</div></div></div></td></tr><tr><td><div class=SSection><div class=SEntry><a href="#Model_Migrations" >Model Migrations</a></div></div></td><td><div class=SSection><div class=SDescription>Data definition functions are available during database Model migration up() or down() functions.</div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#createTable(tableName,...columns...)" >createTable (tableName, ...columns...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Creates a table in the database.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#dropTable(tableName)" >dropTable (tableName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Drops a table  the database.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#renameTable(oldName,newName)" >renameTable (oldName, newName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Renames a table in the database.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#addColumn(tableName,columnName,columnType)" >addColumn (tableName, columnName, columnType)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds a column to a table in the database.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#addIndex(tableName,columnNames,indexType,indexName)" >addIndex (tableName, columnNames, indexType, indexName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds an index to a table in the database.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#removeIndex(tableName,indexName)" >removeIndex (tableName, indexName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Removes an index from the database.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#createStandardTable(tableName,...columns...)" >createStandardTable (tableName, ...columns...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Creates a database table with some standard columns that Junction needs to be able to synchronize the table. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#column(name,type)" id=link11 onMouseOver="ShowTip(event, 'tt11', 'link11')" onMouseOut="HideTip('tt11')">column (name, type)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>A syntatic sugar helper function that creates a column definition array. </div></div></div></td></tr><tr><td><div class=SClass><div class=SEntry><a href="#req" >req</a></div></div></td><td><div class=SClass><div class=SDescription>The req (or request) object is a map object passed to the Controller action method that holds the input parameters for the request. </div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#req.Properties" >Properties</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#req.method" >method</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>A string of either &lsquo;get&rsquo; or &lsquo;post&rsquo;, indicating the HTTP method of the request.</div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#req.controllerName" >controllerName</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>A string of the controller name, such as &lsquo;forum&rsquo;. </div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#req.actionName" >actionName</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>A string of the action method name, such as &lsquo;newInstance&rsquo;, &lsquo;create&rsquo;, &lsquo;edit&rsquo;, &lsquo;show&rsquo;, &lsquo;index&rsquo;, etc. </div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#req.objId" >objId</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>An optional string id that, by convention, refers to a target Model record to perform operations on. </div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#req.session" >session</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>A map object of session variables. </div></div></div></td></tr><tr><td><div class=SClass><div class=SEntry><a href="#res" >res</a></div></div></td><td><div class=SClass><div class=SDescription>The res or response/result object passed to the Controller action method provides methods to control output rendering. </div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#res.Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.render(...)" id=link12 onMouseOver="ShowTip(event, 'tt12', 'link12')" onMouseOut="HideTip('tt12')">render (...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Render a template.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.renderAction(actionName)" >renderAction (actionName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Render a template belonging to the current Controller.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.renderTemplate(templatePath)" >renderTemplate (templatePath)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Render a template given a full template path.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.renderText(text)" >renderText (text)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sets a string to be the result returned to the client.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.redirectTo(...)" >redirectTo (...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sends a HTTP redirect response to the client. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.redirectToArgs(args)" >redirectToArgs (args)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sends a HTTP redirect response to the client.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.redirectToAction(actionName,objId,args)" >redirectToAction (actionName, objId, args)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sends a HTTP redirect response to the client, targeting an action on the current controller.</div></div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#res.Properties" >Properties</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#res.req" >req</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>The req object is available in the res object for convenient access to req properties from templates.</div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#res.session" >session</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>The req.session object is available in the res object for convenient access to session properties from templates.</div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#res.flash" >flash</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>The transient flash hash/map object is available in the res object for convenient access to flash data from templates. </div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent2><a href="#res.layoutName" >layoutName</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent2>Allows the controller to defined the layout used in rendering the response.</div></div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#res.Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.setLocale(localeStr)" id=link13 onMouseOver="ShowTip(event, 'tt13', 'link13')" onMouseOut="HideTip('tt13')">setLocale (localeStr)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Sets the locale string for the current response.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.getLocale" id=link14 onMouseOver="ShowTip(event, 'tt14', 'link14')" onMouseOut="HideTip('tt14')">getLocale ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns the locale string for the current response.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.t(str,defaultResult)" id=link15 onMouseOver="ShowTip(event, 'tt15', 'link15')" onMouseOut="HideTip('tt15')">t (str, defaultResult)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Translate a static string based on the current response locale.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.tChoices(arr)" >tChoices (arr)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Translate an array of choice strings that is usually passed to the res.select() function.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.localDateString(date,withTime)" >localDateString (date, withTime)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Similar to TrimPath.junctionUtil.toLocalDateString(), formats a Date as either &lsquo;YYYY/MM/DD&rsquo; or &lsquo;YYYY/MM/DD hh:mm:ss&rsquo;. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#res.utcDateString(date,withTime)" >utcDateString (date, withTime)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Similar to TrimPath.junctionUtil.toUTCDateString(), formats a Date as either &lsquo;YYYY/MM/DD&rsquo; or &lsquo;YYYY/MM/DD hh:mm:ss&rsquo;. </div></div></div></td></tr><tr><td><div class=SClass><div class=SEntry><a href="#ModelErrors" >ModelErrors</a></div></div></td><td><div class=SClass><div class=SDescription>A ModelErrors object manages the validation error messages for a Model instance.</div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><div class=SIndent1><a href="#ModelErrors.Functions" >Functions</a></div></div></div></td><td><div class=SGroup><div class=SDescription><div class=SIndent1></div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.add" id=link16 onMouseOver="ShowTip(event, 'tt16', 'link16')" onMouseOut="HideTip('tt16')">add</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds an error message that&rsquo;s associated with a named property or field.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.addToBase" >addToBase</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the add_to_base() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.add_to_base" id=link17 onMouseOver="ShowTip(event, 'tt17', 'link17')" onMouseOut="HideTip('tt17')">add_to_base</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Adds an error message assocated with the entire modelInstance.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.on" id=link18 onMouseOver="ShowTip(event, 'tt18', 'link18')" onMouseOut="HideTip('tt18')">on</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns the error messages associated with a particular property or field of a model instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.onBase" >onBase</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the on_base() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.on_base" id=link19 onMouseOver="ShowTip(event, 'tt19', 'link19')" onMouseOut="HideTip('tt19')">on_base</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns the error messages that were associated with the entire model instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.clear" id=link20 onMouseOver="ShowTip(event, 'tt20', 'link20')" onMouseOut="HideTip('tt20')">clear</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Removes all the error messages held by this ModelErrors instance.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.isInvalid" >isInvalid</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the is_invalid() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.is_invalid" id=link21 onMouseOver="ShowTip(event, 'tt21', 'link21')" onMouseOut="HideTip('tt21')">is_invalid</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns whether there are error messages associated with a particular property or field of a model instance.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.count" id=link22 onMouseOver="ShowTip(event, 'tt22', 'link22')" onMouseOut="HideTip('tt22')">count</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns the number of error messages stored in the ModelErrors instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.isEmpty" >isEmpty</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the is_empty() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.is_empty" id=link23 onMouseOver="ShowTip(event, 'tt23', 'link23')" onMouseOut="HideTip('tt23')">is_empty</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns whether there are any error messages stored in the ModelErrors instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.invalidAttributes" >invalidAttributes</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the invalid_attributes() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.invalid_attributes" id=link24 onMouseOver="ShowTip(event, 'tt24', 'link24')" onMouseOut="HideTip('tt24')">invalid_attributes</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns the names of properties/fields that have validation errors.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.fullMessagesOn" >fullMessagesOn</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the full_messages_on() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.full_messages_on" id=link25 onMouseOver="ShowTip(event, 'tt25', 'link25')" onMouseOut="HideTip('tt25')">full_messages_on</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns an Array of error message strings associated with a given attrName. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.fullMessages" >fullMessages</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>An alias for the full_messages() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent2><a href="#ModelErrors.full_messages" id=link26 onMouseOver="ShowTip(event, 'tt26', 'link26')" onMouseOut="HideTip('tt26')">full_messages</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent2>Returns an Array of all error message strings. </div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.Variables"></a>Variables</h3></div></div>

<div class=CVariable><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.env"></a>env</h3><div class=CBody><p class=CParagraph>The env object provides a runtime-environment-specific collection of functions and information that the Junction system requires to work.</p><p class=CParagraph>Application developers can access the TrimPath.junction.env object to check for system/runtime level information.</p><h4 class=CHeading>Examples</h4><p class=CParagraph>var isClientSide = TrimPath.junction.env.type == &lsquo;client&rsquo;; var dbSchema = TrimPath.junction.env.db.getSchema();</p></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.syncUp"></a>syncUp ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>syncUp : function()</td></tr></table></blockquote><p class=CParagraph>Requests an asynchronous synchronization of the local database with the server database.&nbsp;  This is a no-op if invoked in a server runtime environment.</p><p class=CParagraph>If too many syncUp()&rsquo;s are requested in a short time period, the system might ignore the requests.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.isOnline"></a>isOnline ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>isOnline : function()</td></tr></table></blockquote><p class=CParagraph>Returns whether a client-side Junction environment is online (has connectivity to a server).&nbsp;  A server-side Junction environment always returns true for this function.</p><p class=CParagraph>The returned value should be treated as a hint, as network connectivity events are fundamentally non-synchronous.</p><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean true if the client-side system can contact the server, or true if the system is running on the server environment.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.dbExecute(sql,optParams)"></a>dbExecute (sql, optParams)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>dbExecute : function(</td><td class=PParameter nowrap>sql,</td></tr><tr><td></td><td class=PParameter nowrap>optParams</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Executes a SQL query against the local application database.&nbsp; In a client-side web browser environment, the local database might be either a Google Gears RDBMS (sqlite) or an in-memory simple RDBMS (TrimQuery).&nbsp; In the server side, the RDBMS is server-environment and configuration dependent.</p><p class=CParagraph>To achieve highest compatibility to running in all environments, the SQL passed into dbExecute() should be the subset of SQL SELECT query syntax that TrimQuery supports, as TrimQuery supports the fewest features.</p><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>var rs = junction.dbExecute('SELECT Task.* FROM Task WHERE Task.due_at = ?'<br>  [ juntionUtil.toSQLDateString(new Date()) ]);<br><br>var rs = junction.dbExecute('SELECT Person.* FROM Person WHERE Person.name = ?'<br>  [ 'Alfred' ]);<br><br>var rs = junction.dbExecute('SELECT Person.* FROM Person WHERE Person.name IS NOT NULL');<br><br>for (var i = 0; i &lt; rs.length; i++)<br>  alert(rs[i].name);</pre></blockquote><h4 class=CHeading>Paramseters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>sql</td><td class=CDLDescription>A SQL SELECT query string, with optional positional ? placeholders</td></tr><tr><td class=CDLEntry>optParams</td><td class=CDLDescription>An optional array of values, with one value that will be substituted for each placeholder character in the sql string.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>An array of records; possibly an empty array [].&nbsp; Each record object is a map of where keys are column names and values are strings or numbers.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.scaffold(controllerFunc,modelName)"></a>scaffold (controllerFunc, modelName)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>scaffold : function(</td><td class=PParameter nowrap>controllerFunc,</td></tr><tr><td></td><td class=PParameter nowrap>modelName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Provides some simple Controller action methods for a given Model for increased developer productivity.</p><p class=CParagraph>The scaffold() method adds some rudimentary action methods (index, show, update, newInstance, create, destroy) to a given Controller.&nbsp;  This is useful for when starting or prototyping a new application.&nbsp;  The scaffold() method is often less used as an application&rsquo;s codebase matures, as application code usually becomes increasingly customized with added application-specific security, error checking and use-case workflow logic which scaffold() does not supply.</p><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>EmployeeController = function() {}<br>scaffold(EmployeeController, 'Employee');<br><br>OrderLineController = function() {}<br>scaffold(OrderLineController, 'OrderLine');<br><br>OrderLineController.prototype.show = function(req, res) {<br>  ... override the show() action method provided by scaffold()...<br>}</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>controllerFunc</td><td class=CDLDescription>A Controller function object.</td></tr><tr><td class=CDLEntry>modelName</td><td class=CDLDescription>A string of the Model name.&nbsp;  For example, &lsquo;Employee&rsquo;, or &lsquo;OrderLine&rsquo;.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>void.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.beforeFilter(controllerFunc,filterFunc)"></a>beforeFilter (controllerFunc, filterFunc)</h3><div class=CBody><p class=CParagraph>Appends a filter function to the &lsquo;before&rsquo; filter chain of a Controller.&nbsp; The filter function is invoked before the action method of the Controller is invoked.&nbsp;  If the filter function returns the false boolean value, then further processing is halted (further filters and the action method are not invoked).</p><h4 class=CHeading>The filter callback function takes, 3 parameters</h4><ul class=CBulletList><li>controller - the current controller instance</li><li>req - the current request object</li><li>res - the current response object</li></ul><h4 class=CHeading>For example</h4><blockquote><pre class=CCode>InvoiceController = function() {}<br>beforeFilter(InvoiceController, function(controller, req, res) {<br>  // Check that user has access.<br>  // Call req.setLocale().<br>}</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>controllerFunc - The Controller class constructor/function.</li><li>filterFunc - A filter callback function with the signature described above.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>The controllerFunc function parameter, which is useful for chainability.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.modelFor(modelName,func)"></a>modelFor (modelName, func)</h3><div class=CBody><p class=CParagraph>An alias for the modelInit function.&nbsp; Deprecated: Please use the modelInit function.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="TrimPath.junction.modelInit(modelName,func)"></a>modelInit (modelName, func)</h3><div class=CBody><p class=CParagraph>Tells the Junction system that a given function/constructor represents a Model object.&nbsp;  Junction decorates the given function/constructor with class methods such as finders and creators.&nbsp;  These class method decorations provide the object-relational access to CRUD (create-retrieve-update-delete) operations to the RDBMS.</p><p class=CParagraph>For example, after calling modelInit() on a function/constructor, you should use the <u>Model.newInstance()</u> class method to create new, database-aware instances of the Model class, instead of calling <u>new Model()</u> directly.</p><p class=CParagraph>See the <a href="#Model" class=LClass id=link27 onMouseOver="ShowTip(event, 'tt27', 'link27')" onMouseOut="HideTip('tt27')">Model</a> section for information on these class method decorations.</p><p class=CParagraph>Junction follows the Active Record design pattern of object-relational mapping, where one database table is mapped to a single Model class.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>OrderLine = function() {}<br><br>modelInit('OrderLine');<br>OrderLine.belongsTo('Order');<br>OrderLine.belongsTo('Product');<br><br>// Alternatively, you might do...<br><br>OrderLine = function() {}<br><br>with (modelInit('OrderLine')) {<br>  belongsTo('Order');<br>  belongsTo('Product');<br>}<br><br>modelInit('OrderLine').belongsTo('Order');</pre></blockquote><h4 class=CHeading>Parameters</h4><p class=CParagraph>modelName : A string name of the Model function/constructor in JavaScript.</p><h4 class=CHeading>Returns</h4><p class=CParagraph>The Model constructor/function decorated with <a href="#Model_Metadata" class=LSection id=link28 onMouseOver="ShowTip(event, 'tt28', 'link28')" onMouseOut="HideTip('tt28')">Model Metadata</a> methods.</p></div></div></div>

<div class=CSection><div class=CTopic><h2 class=CTitle><a name="Model_Documentation"></a>Model Documentation</h2><div class=CBody><p class=CParagraph>Junction follows the &lsquo;Active Record&rsquo; design pattern for object-relational mapping.&nbsp;  Each Model in the Junction world maps to a single database table.</p><p class=CParagraph>A Model&rsquo;s class name and table name should follow a CamelCaseCaptialization format.&nbsp;  For example, Order, OrderLine, Invoice, InvoiceLine, AccountTransaction.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Order = function() {};<br><br>modelInit('Order')) {<br>Order.belongsTo('Customer');<br>Order.hasMany('OrderLines');<br><br>// Alternative syntax...<br><br>Order = function() {};<br><br>with (modelFor('Order')) {<br>   belongsTo('Customer');<br>   hasMany('OrderLines');<br>}</pre></blockquote><p class=CParagraph>In the above example, the Order function was decorated with a Model class API, via the modelFor() call.&nbsp;  Application code can then make calls on the Order such as...</p><blockquote><pre class=CCode>var expensiveOrders = Order.findActive('all', 'amount &gt; 200');<br><br>var newOrder = Order.newInstance();<br>newOrder.customer_id = currentCustomer.id;<br>newOrder.amount = 100;<br>newOrder.save();</pre></blockquote></div></div></div>

<div class=CClass><div class=CTopic><h2 class=CTitle><a name="Model"></a>Model</h2><div class=CBody><p class=CParagraph>A Model class represents and manages a tables in a database.&nbsp;  Model instances represent individual records in the table.&nbsp;  Models follow the &lsquo;Active Record&rsquo; design pattern for object-relational mapping.</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SGroup><div class=SEntry><a href="#Model.Functions" >Functions</a></div></div></td><td class=SDescriptionSize><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.find" id=link29 onMouseOver="ShowTip(event, 'tt5', 'link29')" onMouseOut="HideTip('tt5')">find ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Queries the database for records of Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.findActive(id,params)" >findActive (id, params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Like find(), but ensures that &lsquo;active = 1&rsquo; is part of the query.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.findAll(params)" >findAll (params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Equivalent to Model.find(&lsquo;all&rsquo;, params).</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.findFirst(params)" >findFirst (params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Equivalent to Model.find(&lsquo;first&rsquo;, params)</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.findBySql(sql)" >findBySql (sql)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Queries the database for Model instances using a full SQL query string.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.countActive(params)" >countActive (params)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Does a SELECT COUNT(*) query for active records.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.newInstance(attrs)" >newInstance (attrs)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Creates a new, unsaved instance of a Model.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.new_instance(attrs)" >new_instance (attrs)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for Model.newInstance(attrs)</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.build(attrs)" >build (attrs)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for Model.newInstance(attrs). </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.isNewRecord" >isNewRecord ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns true if the record is a new, unsaved record.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.isNewInstance" >isNewInstance ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the isNewRecord() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.is_new_instance" >is_new_instance ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the isNewRecord() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.is_new_record" >is_new_record ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the isNewRecord() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.deactivate" id=link30 onMouseOver="ShowTip(event, 'tt6', 'link30')" onMouseOut="HideTip('tt6')">deactivate ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sets the active column of the model instance to 0. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.destroy" id=link31 onMouseOver="ShowTip(event, 'tt7', 'link31')" onMouseOut="HideTip('tt7')">destroy ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Deletes the model record from the local RDBMS. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.save" id=link32 onMouseOver="ShowTip(event, 'tt8', 'link32')" onMouseOut="HideTip('tt8')">save ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Saves a new or updated Model instance to the RDBMS.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.isValid" >isValid ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Runs the validations on the model instance. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.valid" >valid ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the isValid() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.is_valid" >is_valid ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the isValid() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.errors" id=link33 onMouseOver="ShowTip(event, 'tt9', 'link33')" onMouseOut="HideTip('tt9')">errors ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns the ModelErrors object that holds validation error information.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.updateAttributes" >updateAttributes ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Updates several attributes of the modelInstance and saves. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.update_attributes" >update_attributes ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the updateAttributes() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.setConventionalAttributes(...)" id=link34 onMouseOver="ShowTip(event, 'tt10', 'link34')" onMouseOut="HideTip('tt10')">setConventionalAttributes (...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sets the convention-over-configuration field attributes of the Model instance. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#Model.onBeforeSync" >onBeforeSync ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An optional callback function that&rsquo;s called before client-side synchronization.</div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="Model.Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.find"></a>find ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>modelInfo.func.find = function(</td><td class=PParameter nowrap>id,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Queries the database for records of Model.&nbsp; The Model.find() function can be called in several ways:</p><ul class=CBulletList><li>models = Model.find(&lsquo;all&rsquo;, params);</li><li>model  = Model.find(&lsquo;first&rsquo;, params);</li><li>model  = Model.find(id, params);</li><li>models = Model.find([ id1, id2, id3 ], params);</li></ul><h4 class=CHeading>Optional params object</h4><p class=CParagraph>The optional params object is a map object that may have several key/values to specify the query better...</p><ul class=CBulletList><li>conditions - either a string WHERE clause fragment (without the actual WHERE keyword).&nbsp;  For example, &ldquo;Employee.salary &gt; 100 AND Employee.started_at IS NOT NULL&rdquo;.&nbsp; Or, the conditions value may be an Array.&nbsp; The Array&rsquo;s first element is a WHERE clause fragment string, and the remaining elements are bind parameter values.&nbsp;  For example, [ &ldquo;Employee.salary &gt; ? AND Employee.started_at &gt; ?&rdquo;, 10000, aDateString ]</li><li>order - a string that is the body of an ORDER BY clause.&nbsp; For example, &ldquo;Person.lastname ASC, Person.firstname ASC&rdquo;.</li><li>from - a string that optionally allows you to override the table name that is queried.&nbsp;  For example, &ldquo;WikiPageVersion&rdquo;.</li><li>limit - a value is the record total limit in an LIMIT clause.</li><li>offset - a value for the offset part of a LIMIT clause.&nbsp; The offset is only used if the limit is specified.</li></ul><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>Page = function() {};<br><br>modelInit('Page');<br><br>var pages = Page.find('all', {<br>    order: 'Page.title ASC',<br>    conditions: 'active = 1'<br>});<br><br>var pages = Page.find('all', {<br>    order: 'Page.count_hits DESC, Page.title ASC',<br>    conditions: [ 'Page.active = ? AND Page.count_hits &gt; ?',<br>                  1, 100 ]<br>});<br><br>var page = Page.find('first', {<br>    order: 'Page.title ASC',<br>    conditions: [ 'Page.active = ? AND Page.title = ?',<br>                  1, 'My First Blog Post' ]<br>});</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An array of Model instances, or a single Model instance, depending on the arguments passed to Model.find().</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.findActive(id,params)"></a>findActive (id, params)</h3><div class=CBody><p class=CParagraph>Like find(), but ensures that &lsquo;active = 1&rsquo; is part of the query.</p><p class=CParagraph>Queries the database for active records of Model.&nbsp; That is, returns only those records whose active column has a value of 1.</p><p class=CParagraph>The Model.findActive() function can be called in several ways, similar to the Model.find() method:</p><ul class=CBulletList><li>models = Model.findActive(&lsquo;all&rsquo;, params);</li><li>model  = Model.findActive(&lsquo;first&rsquo;, params);</li><li>model  = Model.findActive(id, params);</li><li>models = Model.findActive([ id1, id2, id3 ], params);</li></ul><p class=CParagraph>The active column is automatically created by the Junction system if you created the table using the migration createStandardTable() method.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>params</td><td class=CDLDescription>An optional params object as described in the Model.find() function.</td></tr></table><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>Page = function() {};<br><br>modelInit('Page');<br><br>var pages = Page.findActive('all', {<br>    order: 'Page.title ASC'<br>});<br><br>var pages = Page.findActive('all', {<br>    order: 'Page.count_hits DESC, Page.title ASC',<br>    conditions: [ 'Page.count_hits &gt; ?', 100 ]<br>});<br><br>var page = Page.findActive('first', {<br>    order: 'Page.title ASC',<br>    conditions: [ 'Page.title = ?', 'My First Blog Post' ]<br>});</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An array of Model instances, or a single Model instance, depending on the arguments passed to Model.findActive().</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.findAll(params)"></a>findAll (params)</h3><div class=CBody><p class=CParagraph>Equivalent to Model.find(&lsquo;all&rsquo;, params).</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var employees = Employee.findAll();<br>var marketeers = Employee.findAll({ conditions: &quot;Employee.dept = 'marketing'&quot; });</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>params</td><td class=CDLDescription>An optional params object as described in the Model.find() function.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.findFirst(params)"></a>findFirst (params)</h3><div class=CBody><p class=CParagraph>Equivalent to Model.find(&lsquo;first&rsquo;, params)</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var currentInvoice = Invoice.findFirst({ conditions: [&quot;Invoice.customer_id = ?&quot;, 123] });</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>params</td><td class=CDLDescription>An optional params object as described in the Model.find() function.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.findBySql(sql)"></a>findBySql (sql)</h3><div class=CBody><p class=CParagraph>Queries the database for Model instances using a full SQL query string.</p><p class=CParagraph>The sql query should include a &lsquo;Model.*&rsquo; column selector in the SELECT columns clause.</p><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>var products = Product.findBySql(<br>   'SELECT Product.* FROM Product WHERE Product.active = 1');<br>var products = Product.findBySql(<br>   'SELECT Product.* FROM Product ORDER BY Product.price DESC');<br>var products = Product.findBySql(<br>   [ 'SELECT Product.* FROM Product WHERE Product.name = ? AND Product.active = ?'<br>     'jello', 1 ]);</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>sql</td><td class=CDLDescription>either a string SQL query, such as &ldquo;SELECT Product.* FROM Product WHERE Product.price &gt; 10&rdquo;.&nbsp; Or, an Array to allow for bind parameters.&nbsp; [ &ldquo;SELECT Product.* FROM Product WHERE Product.price &gt; ?&rdquo;, 100000 ]</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of Model instances, or an empty Array [].</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.countActive(params)"></a>countActive (params)</h3><div class=CBody><p class=CParagraph>Does a SELECT COUNT(*) query for active records.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var numTasks = Task.countActive();</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An integer.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.newInstance(attrs)"></a>newInstance (attrs)</h3><div class=CBody><p class=CParagraph>Creates a new, unsaved instance of a Model.</p><p class=CParagraph>If they are part of the table schema, the created_at, updated_at, version, and active columns will be automatically initialized correctly for the returned Model instance.&nbsp; The version and active values will be initialized to the number 1.</p><p class=CParagraph>The id of the returned Model instance will be null or 0, signifying that the record has not been persisted to the local RDBMS yet.&nbsp;  See: the isNewRecord() method.</p><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>var product = Product.newInstance();<br>product.name = 'cereal';<br>product.save();<br><br>var product = Product.newInstance({ name: 'cereal' });<br>product.save();</pre></blockquote><p class=CParagraph>Note that save() might assign a negative id number when saving a new model instance, if the runtime environment is the client-side browser.&nbsp;  Positive id numbers are assigned when running on the server-side, or when the server is synchronizing records created originally on the client-side.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrs</td><td class=CDLDescription>An optional map object of columnName/value pairs used to initialize the unsaved Model instance.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>A newly created, but unsaved Model instance.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.new_instance(attrs)"></a>new_instance (attrs)</h3><div class=CBody><p class=CParagraph>An alias for Model.newInstance(attrs)</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.build(attrs)"></a>build (attrs)</h3><div class=CBody><p class=CParagraph>An alias for Model.newInstance(attrs).&nbsp;  Provides compatibility with Jester.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.isNewRecord"></a>isNewRecord ()</h3><div class=CBody><p class=CParagraph>Returns true if the record is a new, unsaved record.</p><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean, by seeing if the id field of the model instance is non-null and != 0.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.isNewInstance"></a>isNewInstance ()</h3><div class=CBody><p class=CParagraph>An alias for the isNewRecord() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.is_new_instance"></a>is_new_instance ()</h3><div class=CBody><p class=CParagraph>An alias for the isNewRecord() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.is_new_record"></a>is_new_record ()</h3><div class=CBody><p class=CParagraph>An alias for the isNewRecord() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.deactivate"></a>deactivate ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.deactivate = function()</td></tr></table></blockquote><p class=CParagraph>Sets the active column of the model instance to 0.&nbsp; The deactivate() method also save()&rsquo;s the model instance to the local RDBMS (to either the client-side local RDBMS cache, or to the server-side RDBMS, depending on your runtime environment).</p><p class=CParagraph>Application developers should use deactivate() instead of destroy() to allow for synchronization.&nbsp; To the simple synchronization system of Junction, a deactivate() just looks like an regular record update, and is propagated from client-to-server and vice-versa correctly.</p><p class=CParagraph>Also, the application should use findActive() instead of find(), because findActive() usefully checks the active column.</p><p class=CParagraph>Using deactivate() instead of destroy() also allows for a simple implementation of undo&rsquo;ing an apparent &lsquo;delete&rsquo;.</p><p class=CParagraph>At a later date, after deactivation information has synchronized and propagated to all server RDBMS and client RDBMS&rsquo;s, the application can do a purge of the deactivated records by using the destroy() method.&nbsp; Purges that actually destroy() records might also be executed in response to a user UI command.</p><p class=CParagraph>The active column is automatically created by the Junction system if you created the table using the migration createStandardTable() method.</p><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>var p = Product.findActive(42); // p is non-null.<br>p.deactivate();<br>p = Product.findActive(42); // p is null.</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean true if the model instance was updated and saved to the local RDBMS.&nbsp;  A false return value usually means the model instance did not pass validation checks.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.destroy"></a>destroy ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.destroy = function()</td></tr></table></blockquote><p class=CParagraph>Deletes the model record from the local RDBMS.&nbsp; That is, it is equivalent to the pseudo-SQL of &lsquo;DELETE FROM ModelTable WHERE ModelTable.id = {this.id}&rsquo;</p><p class=CParagraph>You should design your applicaton to use the deactivate() method instead of this destroy() method, as deactivate() works for record synchronization.</p><p class=CParagraph>Although destroy() information is propagated by the Junction simple synchronizaton system from the client-side local RDBMS to the server RDBMS, the reverse propagation from server-side RDBMS to all the client-side RDBMS&rsquo;s does not work, because the server-side RDBMS does not track changes and the actual record has been deleted from the table.&nbsp; In contrast, deactivate() information (seeting active to 0) is propagated correctly in both directions, and to all clients.</p><p class=CParagraph>One useful design is to code the application to use deactivate() most of the time, such as in response to user commands.&nbsp; Then, every once in awhile, destroy() can be used to finally purge from the RDBMS&rsquo;s the really old, deactivated records, after a reasonable amount of time has passed for the deactivation info to be propagated to all client-side local RDBMS instances.</p><h4 class=CHeading>Examples</h4><blockquote><pre class=CCode>Product.find(42, {<br>    conditions: [ 'Product.active = 0 AND Product.updated_at &lt; ?',<br>                  threeMonthsAgoSQLDateString ]<br>}).destroy();</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>Void.</p><h4 class=CHeading>Note</h4><p class=CParagraph>The method name &lsquo;destroy()&rsquo; is used instead of &lsquo;delete()&rsquo; because &lsquo;delete&rsquo; is a JavaScript reserved keyword.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.save"></a>save ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.save = function()</td></tr></table></blockquote><p class=CParagraph>Saves a new or updated Model instance to the RDBMS.</p><p class=CParagraph>For a new record, a new id is generated and assigned to the record.&nbsp;  Any conventional table columns, such as updated_at and version, if they exist, will be modified by save() before the actual saving into the local RDBMS.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var p = Product.newInstance({ name: 'iPhone' });<br>p.isNewRecord(); // ... will be true.<br>p.id             // ... will be null or 0.<br>p.save();<br>p.isNewRecord(); // ... will be false.<br>p.id             // ... will be an integer &gt; 0.<br><br>var t = p.updated_at;<br><br>p.price = 100;<br>p.save();<br>p.updated_at != t</pre></blockquote><p class=CParagraph>The RDBMS implementation behind save() will often use an &lsquo;INSERT OR REPLACE&rsquo; statement or equivalent &lsquo;upsert&rsquo; kind of operation to execute the save() method.</p><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean true if the save() was successful.&nbsp; A false return value usually means that validations failed.&nbsp;  See the isValid() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.isValid"></a>isValid ()</h3><div class=CBody><p class=CParagraph>Runs the validations on the model instance.&nbsp; The modelInstance.errors() object will hold validation error information.</p><p class=CParagraph>This validation methods that are run against the model instance, in the following order...</p><ul class=CBulletList><li>this.beforeValidation()</li><li>this.beforeValidationOnCreate/OnUpdate()</li><li>declarative save validations</li><li>declarative create|update validations</li><li>this.validate()</li><li>this.validateOnCreate/OnUpdate()</li><li>this.afterValidation()</li><li>this.afterValidationOnCreate/OnUpdate()</li></ul><p class=CParagraph>The correct xxxValidationOnCreate / xxxValidationOnUpdate method is invoked depending if the model instance is a new record, as determined by calling this.isNewRecord().</p><p class=CParagraph>This method clear()&rsquo;s the this.error()&rsquo;s before running the validations.</p><h4 class=CHeading>Example of defining validation callback methods</h4><blockquote><pre class=CCode>Invoice = function() {}<br>modelInit('Invoice');<br><br>Invoice.prototype.beforeValidation = function() {<br>  // calls this.errors().add() if validation error...<br>}<br>Invoice.prototype.validate = function() {<br>  // calls this.errors().add() if validation error...<br>}<br>Invoice.prototype.validateOnCreate = function() {<br>  // calls this.errors().add() if validation error...<br>}</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean true if there are no validation errors, and false otherwise.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.valid"></a>valid ()</h3><div class=CBody><p class=CParagraph>An alias for the isValid() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.is_valid"></a>is_valid ()</h3><div class=CBody><p class=CParagraph>An alias for the isValid() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.errors"></a>errors ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.errors = function()</td></tr></table></blockquote><p class=CParagraph>Returns the ModelErrors object that holds validation error information.</p><p class=CParagraph>After running validations, the modelInstance.errors() object will contain information about each validation error.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var p = Product.findActive(42);<br>p.errors().isEmpty() == true;<br>p.price = -20;<br>p.errors().isEmpty() == true;<br>p.validate() == false;<br>p.errors().isEmpty() == false;<br>p.errors().clear();<br>p.errors().isEmpty() == true;<br>p.save() == false;<br>p.errors().isEmpty() == false;</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An instance of ModelErrors that&rsquo;s associated with the Model instance.&nbsp;  Calling errors() multiple times returns the same ModelErrors instance.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.updateAttributes"></a>updateAttributes ()</h3><div class=CBody><p class=CParagraph>Updates several attributes of the modelInstance and saves.&nbsp; Uses the given map object parameter (attrs) to set several column/value pairs at the same time, and automatically calls save() on the modelInstance.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var product = Product.findActive(42);<br>product.updateAttributes({<br>    price: 120.0,<br>    sale_price: 20,<br>    sale_ends_at: '2007-10-07 00:00:00Z'<br>});</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrs</td><td class=CDLDescription>A map object whose keys are column names, and values are are column values.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean value, the same as modelInstance.save().</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.update_attributes"></a>update_attributes ()</h3><div class=CBody><p class=CParagraph>An alias for the updateAttributes() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.setConventionalAttributes(...)"></a>setConventionalAttributes (...)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>modelInfo.func.prototype.setConventionalAttributes = function(</td><td class=PParameter nowrap>skipVersion</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Sets the convention-over-configuration field attributes of the Model instance.&nbsp;  For example, this method will update the created_at and updated_at fields appropriately, and increment the version number field, if they are present.&nbsp;  It does not save the Model instance, only changes the Model instance/object hash/map values.</p><p class=CParagraph>setConventionalAttributes() is called by the save() and newInstance() implementations.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="Model.onBeforeSync"></a>onBeforeSync ()</h3><div class=CBody><p class=CParagraph>An optional callback function that&rsquo;s called before client-side synchronization.</p><p class=CParagraph>Developers can provide a Model.onBeforeSync() callback function for each Model constructor/function.&nbsp;  The Junction system will invoke this optional Model.onBeforeSync() function during attempted client-side synchronization.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Invoice = function() {}<br>modelInit('Invoice');<br>  ...<br>}<br>Invoice.onBeforeSync = function() {<br>   if (TrimPath.junction.env.getInfo('userKey') == null ||<br>        TrimPath.junction.env.getInfo('userKey').length &lt;= 0)<br>       return false; // No sync for anonymous users.<br>}</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean false value signals to Junction that the table or model should not be synchronized.</p></div></div></div>

<div class=CSection><div class=CTopic><h2 class=CTitle><a name="Model_Metadata"></a>Model Metadata</h2><div class=CBody><p class=CParagraph>The metadata for a Model defines the object-relational mapping between the JavaScript Model object and a database table in the RDBMS.&nbsp;  For example, you can define name mappings, column validations, and relationships between Models.</p><p class=CParagraph>The metadata is accessed by calling the modelInit() method, usually using its returned value as the scope target object of a <u>with() {...}</u> statement in JavaScript.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Employee = function() {}<br><br>modelInit('Employee');<br>Employee.belongsTo('Company');<br>Employee.belongsTo('Manager');</pre></blockquote><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SGroup><div class=SEntry><a href="#Functions" >Functions</a></div></div></td><td class=SDescriptionSize><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#tableName(tableNameVal)" >tableName (tableNameVal)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Tells junction the name of the table in the database that maps to the Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#pluralName(pluralNameVal)" >pluralName (pluralNameVal)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Tells junction the plural name of the Model. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#hasMany(childPluralName,info)" >hasMany (childPluralName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Associates a Model (a &lsquo;parent&rsquo;) in a has-many relationship with a &lsquo;child&rsquo; Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#hasManyActive(childPluralName,info)" >hasManyActive (childPluralName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Similar to hasMany(), but uses findActive() instead of find() for the generated child getter function. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#belongsTo(parentName,info)" >belongsTo (parentName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Associates a child Model with a parent Model. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#belongsToActive(parentName,info)" >belongsToActive (parentName, info)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Similar to belongsTo(), but uses findActive() instead of find for the generated parent getter function. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#validatesFormatOf(attrName,regexp,msg,on)" >validatesFormatOf (attrName, regexp, msg, on)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds a field/column validation rule based on a regular expression.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#validatesInclusionOf(attrName,inArray,msg,on)" >validatesInclusionOf (attrName, inArray, msg, on)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds a field/column validation rule based an array of allowed values.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#validatesPresenceOf(attrName,msg,on)" >validatesPresenceOf (attrName, msg, on)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds a field/column validation rule checking for non-null.</div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="tableName(tableNameVal)"></a>tableName (tableNameVal)</h3><div class=CBody><p class=CParagraph>Tells junction the name of the table in the database that maps to the Model.&nbsp;  By default, Junction assumes the name of the Model to be the same as the table name, unless overridden by calling the table_name method.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Blog');<br>Blog.tableName('blog_entries');<br><br>modelInit('Order');<br>Order.tableName('orders');</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>tableNameVal</td><td class=CDLDescription>A string of the SQL table name.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="pluralName(pluralNameVal)"></a>pluralName (pluralNameVal)</h3><div class=CBody><p class=CParagraph>Tells junction the plural name of the Model.&nbsp; By default, Junction assumes the plural name of is just the model name concatenated with an &lsquo;s&rsquo;.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Person');<br>Person.pluralName('People');</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>pluralNameVal</td><td class=CDLDescription>A string.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="hasMany(childPluralName,info)"></a>hasMany (childPluralName, info)</h3><div class=CBody><p class=CParagraph>Associates a Model (a &lsquo;parent&rsquo;) in a has-many relationship with a &lsquo;child&rsquo; Model.&nbsp;  The child Model should have a foreign-key column that references the parent Model&rsquo;s id column.</p><p class=CParagraph>For example, if Company is the parent Model, then a child Model of Employee should have a foreign-key column such as company_id.</p><p class=CParagraph>When you define a hasMany relationship, Junction will automatically add a child getter function to the parent Model prototype for easier navigation.&nbsp; The generated child getter function will be named get{childPluralName}.&nbsp; For example, getEmployees.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Company = function() {}<br>Employee = function() {}<br>DigitalGood = function() {}<br><br>modelInit('Company');<br>Company.hasMany('Employees');<br>Company.hasMany('DigitalGoods');<br><br>var company = Company.find(17);<br><br>var employees = Company.getEmployees();<br>// This is the same as...<br>var employees = Employee.find('all', { conditions: 'Employee.company_id = 17' });<br><br>var goods = Company.getDigitalGoods();<br>// This is the same as...<br>var goods = DigitalGoods.find('all', { conditions: 'DigitalGoods.company_id = 17' });<br><br>// Results are cached unless a reload is forced...<br>var employees1 = Company.getEmployees();<br>var employees2 = Company.getEmployees();<br>// employees1 == employees2<br>var employees3 = Company.getEmployees(true); // Force a reload.<br>// employees3 != employees2</pre></blockquote><h4 class=CHeading>Optional info</h4><p class=CParagraph>The second parameter to hash_many() is an optional map object where you can specificy more details about the relationship and override default behavior.&nbsp;  The key/value options you can define in the info map object are...</p><ul class=CBulletList><li>modelName - a string of the singular name of the child Model.&nbsp; Defaults to the childPluralName parameter stripped of its &lsquo;s&rsquo; suffix character.&nbsp;  For example, OrderLines becomes a singular child Model name of OrderLine.&nbsp; Use the modelName option when when pluralization or singularization is not so simplistic or when you have adjectives on the relationship.&nbsp; For example...</li></ul><blockquote><pre class=CCode>hasMany('People', { modelName : 'Person' })<br>hasMany('OpenTasks', { modelName : 'Task' })<br>hasMany('ClosedTasks', { modelName : 'Task' })</pre></blockquote><ul class=CBulletList><li>foreignKey - a string of the column name in the child table that serves as the foreign key to the parent table.&nbsp; For example...</li></ul><blockquote><pre class=CCode>hasMany('Subdirectories', { modelName : 'Directory',<br>                            foreignKey : 'parent_id' })</pre></blockquote><ul class=CBulletList><li>conditions - a string fragment of a SQL WHERE clause that is AND&rsquo;ed as part of the query to provide a tighter result set.&nbsp; For example...</li></ul><blockquote><pre class=CCode>hasMany('OpenTasks',   { modelName  : 'Task',<br>                         conditions : &quot;Task.status = 'open'&quot; })<br>hasMany('ClosedTasks', { modelName  : 'Task',<br>                         conditions : &quot;Task.state = 'closed'' })</pre></blockquote><ul class=CBulletList><li>active - a boolean true value if you want the generated child getter function to only return active child Model objects, whose active column == 1.</li></ul><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>childPluralName</td><td class=CDLDescription>A string of the child Model name, pluralized.</td></tr><tr><td class=CDLEntry>info</td><td class=CDLDescription>An optional options map object.</td></tr></table><h4 class=CHeading>See also</h4><ul class=CBulletList><li>hasManyActive() which works better for replicated database situations.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="hasManyActive(childPluralName,info)"></a>hasManyActive (childPluralName, info)</h3><div class=CBody><p class=CParagraph>Similar to hasMany(), but uses findActive() instead of find() for the generated child getter function.&nbsp;  That is, only child Models that have active == 1 will be returned by the generated getter.</p><p class=CParagraph>You&rsquo;ll often use hasManyActive() instead of hasMany() to allow for correct replication of data between RDBMS&rsquo;s, especially deactivated data.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Company');<br>Company.hasManyActive('Employees');<br>Company.hasManyActive('OnlineDocuments');</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>childPluralName</td><td class=CDLDescription>A string of the child Model name, pluralized.</td></tr><tr><td class=CDLEntry>info</td><td class=CDLDescription>An optional options map object.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="belongsTo(parentName,info)"></a>belongsTo (parentName, info)</h3><div class=CBody><p class=CParagraph>Associates a child Model with a parent Model.&nbsp;  The child Model should have a foreign-key column that references the parent Model&rsquo;s id column.</p><p class=CParagraph>For example, if Employee is the child Model, then it should have a foreign-key column such as company_id to associate it with a parent Company Model.</p><p class=CParagraph>When you define a belongs_to relationship on a child Model, Junction will automatically add a parent getter function to the child Model prototype for easier navigation.&nbsp; The generated parent getter function will be named get{parentName}.&nbsp;  For example, getCompany.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Company = function() {}<br>Employee = function() {}<br><br>modelInit('Employee');<br>Employee.belongsTo('Company');<br>Employee.belongsTo('Manager', { modelName:  'Employee',<br>                                foreignKey: 'manager_id' });<br><br>var emp = Employee.find(51);<br><br>var company = emp.getCompany();<br>// This is the same as...<br>var company = Company.find('first', { conditions: [ 'Company.id = ?', emp.company_id ] });<br><br>var mgr = emp.getManager();<br>// This is the same as...<br>var mgr = Employee.find('first', { conditions: 'Employee.id = ?', emp.manager_id });<br><br>// Results are cached unless a reload is forced...<br>var company1 = emp.getCompany();<br>var company2 = emp.getCompany();<br>var company3 = emp.getCompany(true);<br>// company1 == company2<br>// company1 != company3</pre></blockquote><h4 class=CHeading>Optional info</h4><p class=CParagraph>The second parameter to belongsTo() is an optional map object where you can specificy more details about the relationship and override default behavior.&nbsp;  The key/value options you can define in the info map object are...</p><ul class=CBulletList><li>modelName - a string of the singular name of the parent Model.&nbsp; Defaults to the parentName parameter Use the modelName option when the parentName doesn&rsquo;t refer to a real Model, such as in the Employee/Manager example in the code above.</li><li>foreignKey - a string of the column name in the child table that serves as the foreign key to the parent table.&nbsp; Defaults to the uncaptialized parentName parameter with a &lsquo;_id&rsquo; suffix.&nbsp; For example...</li></ul><blockquote><pre class=CCode>belongsTo('ParentDirectory', { modelName : 'Directory',<br>                               foreignKey : 'parent_id' })</pre></blockquote><ul class=CBulletList><li>active - a boolean true value if you want the generated parent getter function to only return an active parent Model object, whose active column == 1.</li></ul><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>parentName</td><td class=CDLDescription>A string of the parent Model name.</td></tr><tr><td class=CDLEntry>info</td><td class=CDLDescription>An optional options map object.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="belongsToActive(parentName,info)"></a>belongsToActive (parentName, info)</h3><div class=CBody><p class=CParagraph>Similar to belongsTo(), but uses findActive() instead of find for the generated parent getter function.&nbsp;  That is, only parent Models that have active == 1 will be returned by the generated getter.</p><p class=CParagraph>You&rsquo;ll often use belongsToActive() instead of belongsTo() to allow for correct replication of data between RDBMS&rsquo;s, especially deactivated data.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Employee');<br>Employee.belongsToActive('Company');<br>Employee.belongsToActive('Department');</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>parentName</td><td class=CDLDescription>A string of the parent Model name.</td></tr><tr><td class=CDLEntry>info</td><td class=CDLDescription>An optional options map object.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="validatesFormatOf(attrName,regexp,msg,on)"></a>validatesFormatOf (attrName, regexp, msg, on)</h3><div class=CBody><p class=CParagraph>Adds a field/column validation rule based on a regular expression.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Employee');<br>Employee.validatesFormatOf('login', /[A-Za-z0-9]+/);</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string of the he attribute or column name to validate.</td></tr><tr><td class=CDLEntry>regexp</td><td class=CDLDescription>A regular expression which needs to match the attribute or column value in order to pass validation.</td></tr><tr><td class=CDLEntry>msg</td><td class=CDLDescription>An optional string error message clause.&nbsp;  Default to &lsquo;is invalid&rsquo;, so that a final error message such as &lsquo;date of birth is invalid&rsquo; will be generated.</td></tr><tr><td class=CDLEntry>on</td><td class=CDLDescription>An optional string of &lsquo;save&rsquo;, &lsquo;create&rsquo;, or &lsquo;update&rsquo;.&nbsp;  Defaults to &lsquo;save&rsquo;.&nbsp; Determines when the validation will be checked.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="validatesInclusionOf(attrName,inArray,msg,on)"></a>validatesInclusionOf (attrName, inArray, msg, on)</h3><div class=CBody><p class=CParagraph>Adds a field/column validation rule based an array of allowed values.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Employee');<br>Employee.validatesInclusionOf('gender', ['m', 'f']);</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string of the he attribute or column name to validate.</td></tr><tr><td class=CDLEntry>inArray</td><td class=CDLDescription>An Array.&nbsp;  The column value must be a member of the Array in order to pass validation.</td></tr><tr><td class=CDLEntry>msg</td><td class=CDLDescription>An optional string error message clause.&nbsp;  Default to &lsquo;is not included in the list&rsquo;, so that a final error message such as &lsquo;gender is not included in the list&rsquo; will be generated.</td></tr><tr><td class=CDLEntry>on</td><td class=CDLDescription>An optional string of &lsquo;save&rsquo;, &lsquo;create&rsquo;, or &lsquo;update&rsquo;.&nbsp;  Defaults to &lsquo;save&rsquo;.&nbsp; Determines when the validation will bechecked.</td></tr></table></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="validatesPresenceOf(attrName,msg,on)"></a>validatesPresenceOf (attrName, msg, on)</h3><div class=CBody><p class=CParagraph>Adds a field/column validation rule checking for non-null.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>modelInit('Employee');<br>Employee.validatesPresenceOf('first_name');<br>Employee.validatesPresenceOf('last_name');</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string of the he attribute or column name to validate.</td></tr><tr><td class=CDLEntry>msg</td><td class=CDLDescription>An optional string error message clause.&nbsp;  Default to &ldquo;can&rsquo;t be empty&rdquo;, so that a final error message such as &lsquo;last name can&rsquo;t be empty&rsquo; will be generated.</td></tr><tr><td class=CDLEntry>on</td><td class=CDLDescription>An optional string of &lsquo;save&rsquo;, &lsquo;create&rsquo;, or &lsquo;update&rsquo;.&nbsp;  Defaults to &lsquo;save&rsquo;.&nbsp; Determines when the validation will be checked.</td></tr></table></div></div></div>

<div class=CSection><div class=CTopic><h2 class=CTitle><a name="Model_Migrations"></a>Model Migrations</h2><div class=CBody><p class=CParagraph>Data definition functions are available during database Model migration up() or down() functions.</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SGroup><div class=SEntry><a href="#Functions" >Functions</a></div></div></td><td class=SDescriptionSize><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#createTable(tableName,...columns...)" >createTable (tableName, ...columns...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Creates a table in the database.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#dropTable(tableName)" >dropTable (tableName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Drops a table  the database.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#renameTable(oldName,newName)" >renameTable (oldName, newName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Renames a table in the database.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#addColumn(tableName,columnName,columnType)" >addColumn (tableName, columnName, columnType)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds a column to a table in the database.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#addIndex(tableName,columnNames,indexType,indexName)" >addIndex (tableName, columnNames, indexType, indexName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds an index to a table in the database.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#removeIndex(tableName,indexName)" >removeIndex (tableName, indexName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Removes an index from the database.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#createStandardTable(tableName,...columns...)" >createStandardTable (tableName, ...columns...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Creates a database table with some standard columns that Junction needs to be able to synchronize the table. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#column(name,type)" id=link35 onMouseOver="ShowTip(event, 'tt11', 'link35')" onMouseOut="HideTip('tt11')">column (name, type)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>A syntatic sugar helper function that creates a column definition array. </div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="createTable(tableName,...columns...)"></a>createTable (tableName, ...columns...)</h3><div class=CBody><p class=CParagraph>Creates a table in the database.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>createTable('Invoice', column('amount', 'integer'),<br>                       column('cust_id', 'integer'));<br><br>createTable('Invoice', [ 'amount', 'integer' ],<br>                       [ 'cust_id', 'integer' ]);</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>tableName - A string name for the database table, usually capitalized (like &lsquo;Invoice&rsquo;).</li><li>columnArray(s) - A variable number of columnArray parameters, where each columnArray has a column name string and a column type string.&nbsp; Examples of column type strings include &lsquo;integer&rsquo;, &lsquo;varchar(100)&rsquo;, &lsquo;datetime&rsquo;.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="dropTable(tableName)"></a>dropTable (tableName)</h3><div class=CBody><p class=CParagraph>Drops a table  the database.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>tableName - A string name of a database table.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="renameTable(oldName,newName)"></a>renameTable (oldName, newName)</h3><div class=CBody><p class=CParagraph>Renames a table in the database.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>oldName - A string name of a database table.</li><li>newName - A string name of a database table.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="addColumn(tableName,columnName,columnType)"></a>addColumn (tableName, columnName, columnType)</h3><div class=CBody><p class=CParagraph>Adds a column to a table in the database.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>tableName - A string name of a database table.</li><li>columnName - A string name for a column, usually all lowercase with underscore (_) word separators.&nbsp;  For example: &lsquo;parent_invoice_id&rsquo;</li><li>columnType - A string name for a column type.&nbsp; For example, &lsquo;integer&rsquo;, &lsquo;varchar(100)&rsquo;, &lsquo;datetime&rsquo;.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="addIndex(tableName,columnNames,indexType,indexName)"></a>addIndex (tableName, columnNames, indexType, indexName)</h3><div class=CBody><p class=CParagraph>Adds an index to a table in the database.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>tableName - A string name of a database table.</li><li>columnNames - Either an individual column name string or an array of column name strings.</li><li>indexType - Either null, or the string &lsquo;UNIQUE&rsquo;.</li><li>indexName - A string name for the index.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="removeIndex(tableName,indexName)"></a>removeIndex (tableName, indexName)</h3><div class=CBody><p class=CParagraph>Removes an index from the database.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>tableName - A string name of a database table.</li><li>indexName - A string name of the index to remove.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="createStandardTable(tableName,...columns...)"></a>createStandardTable (tableName, ...columns...)</h3><div class=CBody><p class=CParagraph>Creates a database table with some standard columns that Junction needs to be able to synchronize the table.&nbsp; You&rsquo;ll often use createStandardTable() for most of your tables.</p><p class=CParagraph>The columns (and their types) that createStandardTable() adds to your table definition include...</p><ul class=CBulletList><li>[&lsquo;id&rsquo;,          &lsquo;integer&rsquo;, &lsquo;primary key autoincrement&rsquo;],</li><li>[&lsquo;created_at&rsquo;,  &lsquo;datetime&rsquo;],</li><li>[&lsquo;updated_at&rsquo;,  &lsquo;datetime&rsquo;],</li><li>[&lsquo;active&rsquo;,      &lsquo;integer&rsquo;],</li><li>[&lsquo;version&rsquo;,     &lsquo;integer&rsquo;],</li><li>[&lsquo;id_start&rsquo;,    &lsquo;integer&rsquo;],</li><li>[&lsquo;id_start_db&rsquo;, &lsquo;varchar(40)&rsquo;],</li><li>[&lsquo;synced_at&rsquo;,   &lsquo;datetime&rsquo;]</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="column(name,type)"></a>column (name, type)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ddl.column = function()</td></tr></table></blockquote><p class=CParagraph>A syntatic sugar helper function that creates a column definition array.&nbsp; Often used with createTable and createStandardTable.</p><h4 class=CHeading>For example</h4><blockquote><pre class=CCode>createStandardTable('Project'<br>  column('name',     'varchar(100)'),<br>  column('duration', 'integer')<br>);<br>// ... is the same as ...<br>createStandardTable('Project'<br>  [ 'name',     'varchar(100)' ],<br>  [ 'duration', 'integer' ]<br>);</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of its parameters, which can be used as a column definition array for the createTable and createStandardTable functions.</p></div></div></div>

<div class=CClass><div class=CTopic><h2 class=CTitle><a name="req"></a>req</h2><div class=CBody><p class=CParagraph>The req (or request) object is a map object passed to the Controller action method that holds the input parameters for the request.&nbsp;  A few special parameters setup by the Junction system are documented here (including method, controllerName, actionName, etc)...</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SGroup><div class=SEntry><a href="#req.Properties" >Properties</a></div></div></td><td class=SDescriptionSize><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#req.method" >method</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>A string of either &lsquo;get&rsquo; or &lsquo;post&rsquo;, indicating the HTTP method of the request.</div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#req.controllerName" >controllerName</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>A string of the controller name, such as &lsquo;forum&rsquo;. </div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#req.actionName" >actionName</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>A string of the action method name, such as &lsquo;newInstance&rsquo;, &lsquo;create&rsquo;, &lsquo;edit&rsquo;, &lsquo;show&rsquo;, &lsquo;index&rsquo;, etc. </div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#req.objId" >objId</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>An optional string id that, by convention, refers to a target Model record to perform operations on. </div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#req.session" >session</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>A map object of session variables. </div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="req.Properties"></a>Properties</h3></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="req.method"></a>method</h3><div class=CBody><p class=CParagraph>A string of either &lsquo;get&rsquo; or &lsquo;post&rsquo;, indicating the HTTP method of the request.</p></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="req.controllerName"></a>controllerName</h3><div class=CBody><p class=CParagraph>A string of the controller name, such as &lsquo;forum&rsquo;.&nbsp;  The Junction system converts such a controllerName to a function/constructor such as ForumController.</p></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="req.actionName"></a>actionName</h3><div class=CBody><p class=CParagraph>A string of the action method name, such as &lsquo;newInstance&rsquo;, &lsquo;create&rsquo;, &lsquo;edit&rsquo;, &lsquo;show&rsquo;, &lsquo;index&rsquo;, etc.&nbsp;  The Junction system looks for a method on the Controller with a name of actionName to invoke.&nbsp;  Junction will not invoke any action method whose name starts with the underscore (&lsquo;_&rsquo;) character, assumign such methods are private and not web request accessible.</p></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="req.objId"></a>objId</h3><div class=CBody><p class=CParagraph>An optional string id that, by convention, refers to a target Model record to perform operations on.&nbsp;  For example, &ldquo;?controllerName=forum&amp;actionName=show&amp;objId=224&rdquo; is usually interpreted as invoke the show method on the ForumController, targeting the Forum record with id of 234.</p></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="req.session"></a>session</h3><div class=CBody><p class=CParagraph>A map object of session variables.&nbsp;  Note that you cannot have a normal request parameter whose name is &lsquo;session&rsquo;.</p></div></div></div>

<div class=CClass><div class=CTopic><h2 class=CTitle><a name="res"></a>res</h2><div class=CBody><p class=CParagraph>The res or response/result object passed to the Controller action method provides methods to control output rendering.&nbsp;  It is also usable as a map object, allowing the Controller action method to share data with the View template for rendering.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>InvoiceController.prototype.show = function(req, res) {<br>  res.invoice = Invoice.findActive('first', req.objId);<br>  res.products = Product.findAcitve('all');<br><br>  // Both res['invoice'] and res['products'] will be<br>  // available to the template as just invoice and products<br>}</pre></blockquote><h4 class=CHeading>Rendering</h4><p class=CParagraph>By default, if your Controller action method does not invoke a render() kind of method, the Junction system will automatically invoke render() for you after your action method finishes.</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SGroup><div class=SEntry><a href="#res.Functions" >Functions</a></div></div></td><td class=SDescriptionSize><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.render(...)" id=link36 onMouseOver="ShowTip(event, 'tt12', 'link36')" onMouseOut="HideTip('tt12')">render (...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Render a template.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.renderAction(actionName)" >renderAction (actionName)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Render a template belonging to the current Controller.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.renderTemplate(templatePath)" >renderTemplate (templatePath)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Render a template given a full template path.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.renderText(text)" >renderText (text)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sets a string to be the result returned to the client.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.redirectTo(...)" >redirectTo (...)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sends a HTTP redirect response to the client. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.redirectToArgs(args)" >redirectToArgs (args)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sends a HTTP redirect response to the client.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.redirectToAction(actionName,objId,args)" >redirectToAction (actionName, objId, args)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sends a HTTP redirect response to the client, targeting an action on the current controller.</div></div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><a href="#res.Properties" >Properties</a></div></div></td><td><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#res.req" >req</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>The req object is available in the res object for convenient access to req properties from templates.</div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#res.session" >session</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>The req.session object is available in the res object for convenient access to session properties from templates.</div></div></div></td></tr><tr class=SMarked><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#res.flash" >flash</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>The transient flash hash/map object is available in the res object for convenient access to flash data from templates. </div></div></div></td></tr><tr><td><div class=SProperty><div class=SEntry><div class=SIndent1><a href="#res.layoutName" >layoutName</a></div></div></div></td><td><div class=SProperty><div class=SDescription><div class=SIndent1>Allows the controller to defined the layout used in rendering the response.</div></div></div></td></tr><tr><td><div class=SGroup><div class=SEntry><a href="#res.Functions" >Functions</a></div></div></td><td><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.setLocale(localeStr)" id=link37 onMouseOver="ShowTip(event, 'tt13', 'link37')" onMouseOut="HideTip('tt13')">setLocale (localeStr)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Sets the locale string for the current response.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.getLocale" id=link38 onMouseOver="ShowTip(event, 'tt14', 'link38')" onMouseOut="HideTip('tt14')">getLocale ()</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns the locale string for the current response.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.t(str,defaultResult)" id=link39 onMouseOver="ShowTip(event, 'tt15', 'link39')" onMouseOut="HideTip('tt15')">t (str, defaultResult)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Translate a static string based on the current response locale.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.tChoices(arr)" >tChoices (arr)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Translate an array of choice strings that is usually passed to the res.select() function.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.localDateString(date,withTime)" >localDateString (date, withTime)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Similar to TrimPath.junctionUtil.toLocalDateString(), formats a Date as either &lsquo;YYYY/MM/DD&rsquo; or &lsquo;YYYY/MM/DD hh:mm:ss&rsquo;. </div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#res.utcDateString(date,withTime)" >utcDateString (date, withTime)</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Similar to TrimPath.junctionUtil.toUTCDateString(), formats a Date as either &lsquo;YYYY/MM/DD&rsquo; or &lsquo;YYYY/MM/DD hh:mm:ss&rsquo;. </div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="res.Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.render(...)"></a>render (...)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>render : function(</td><td class=PParameter nowrap>templateName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Render a template.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>ForumController.prototype.show = function(req, res) [<br>  res.forum = Forum.findActive('first', req.objId);<br>  res.render('forum/show'); // This is the same as calling res.render()<br>                            // without any parameters.  Also, if you didn't make<br>                            // any res.render() call, Junction would automatically<br>                            // implicitly call res.render() anyways.<br>}</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>templateName - An optional string name of a template, in the format of &lsquo;{controllerName}/{actionName}&rsquo;.&nbsp; Defaults to the current controllerName/actionName.&nbsp; The template rendered will be found under &lsquo;/app/views/{controllerName}/{actionName}.(jst|est)&rsquo;</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>A string of the rendered/processed template text.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.renderAction(actionName)"></a>renderAction (actionName)</h3><div class=CBody><p class=CParagraph>Render a template belonging to the current Controller.</p><p class=CParagraph>The renderAction() method is similar to the render() method, except that it assumes the controllerName is the current controllerName in the request being processed.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>actionName - The actionName used to construct the template path..</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>A string of the rendered/processed template text.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.renderTemplate(templatePath)"></a>renderTemplate (templatePath)</h3><div class=CBody><p class=CParagraph>Render a template given a full template path.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>templatePath - A string template path, such as &lsquo;/app/views/blog/show&rsquo;.&nbsp; The template path suffix should not be specified, as Junction will search for the template using all the template suffixes it understands, like &lsquo;.jst&rsquo; and &lsquo;.est&rsquo;.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>A string of the rendered/processed template text.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.renderText(text)"></a>renderText (text)</h3><div class=CBody><p class=CParagraph>Sets a string to be the result returned to the client.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>res.renderText('&lt;html&gt;&lt;body&gt;Hello, ' + new Date() + '&lt;/body&gt;&lt;/html&gt;');</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>text - A string, usually HTML or XML or JSON.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>The text string.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.redirectTo(...)"></a>redirectTo (...)</h3><div class=CBody><p class=CParagraph>Sends a HTTP redirect response to the client.&nbsp;  The client, in turn, will make another request to another controller/action.</p><h4 class=CHeading>Multiple call signatures</h4><p class=CParagraph>The redirectTo method supports two call signatures...</p><ul class=CBulletList><li>redirectTo(controllerName, actionName, objId (optional), args (optional))</li><li>redirectTo(args)</li></ul><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var invoice = Invoice.newInstance(req);<br>if (invoice.save())<br>    return res.redirectTo('invoice', 'show', invoice.id);<br>// ?controllerName=invoice&amp;actionName=show&amp;objId=invoice.id<br><br>res.redirectTo('invoice', 'list');<br>// ?controllerName=invoice&amp;actionName=list</pre></blockquote><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>res.redirectTo('wiki', 'search', null, {<br>  query : 'washington',<br>  page : 1,<br>  results_per_page : 50 });<br>// ?controllerName=wiki&amp;action=search&amp;query=space shuttle&amp;page=1&amp;results_per_page=50</pre></blockquote><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>res.redirectTo({ controllerName : 'wiki',<br>                 actionName : 'search',<br>                 query : 'washington',<br>                 page : 1,<br>                 results_per_page : 50 });<br>// ?controllerName=wiki&amp;action=search&amp;query=space shuttle&amp;page=1&amp;results_per_page=50</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>controllerName - A string for the name of the Controller to redirect to.</li><li>actionName - A string for the action method name to redirect to.</li><li>objId - An optional string for the objId to redirect to.</li><li>args - An optional map object containing key/value parameters for the redirect request.&nbsp;  A special &lsquo;url&rsquo; key/value in the args map overrides everything, sending the redirect to just the given url.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>void</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.redirectToArgs(args)"></a>redirectToArgs (args)</h3><div class=CBody><p class=CParagraph>Sends a HTTP redirect response to the client.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>res.redirectToArgs({ url: 'http://rubyonrails.com' })<br><br>res.redirectToArgs({ controllerName : 'invoice',<br>                     actionName : 'show',<br>                     objId : 117,<br>                     levelOfDetail : 'full' });</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>args - A map object containing key/value parameters for the redirect request.&nbsp;  A special &lsquo;url&rsquo; key/value in the args map overrides everything, sending the redirect to just the given url.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>void</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.redirectToAction(actionName,objId,args)"></a>redirectToAction (actionName, objId, args)</h3><div class=CBody><p class=CParagraph>Sends a HTTP redirect response to the client, targeting an action on the current controller.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>if (contact.save()<br>    res.redirectToAction('show', contact.id);<br>else<br>    res.redirectToAction('edit', contact.id);</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>actionName - A string action method name.</li><li>objId - An optional target id for the action to focus on.</li><li>args - A map object containing key/value parameters for the redirect request.&nbsp;  A special &lsquo;url&rsquo; key/value in the args map overrides everything, sending the redirect to just the given url.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>void</p></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="res.Properties"></a>Properties</h3></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="res.req"></a>req</h3><div class=CBody><p class=CParagraph>The req object is available in the res object for convenient access to req properties from templates.</p><h4 class=CHeading>Example</h4><p class=CParagraph>&lt;%= req[&lsquo;controllerName&rsquo;] %&gt; &lt;%= req[&lsquo;actionName&rsquo;] %&gt; &lt;%= req[&lsquo;invoiceTotal&rsquo;] %&gt;</p></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="res.session"></a>session</h3><div class=CBody><p class=CParagraph>The req.session object is available in the res object for convenient access to session properties from templates.</p><h4 class=CHeading>Example</h4><p class=CParagraph>&lt;% session.sessionStartTime = session.sessionStartTime || (new Date().toString()) %&gt; &lt;%= session.sessionStartTime %&gt;</p></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="res.flash"></a>flash</h3><div class=CBody><p class=CParagraph>The transient flash hash/map object is available in the res object for convenient access to flash data from templates.&nbsp;  Any scalar data of simple types (e.g.&nbsp; Strings) stored in the res.flash object are available right after a res.redirect() call in the redirected controller.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>BlogPostController.prototype.create = function(req, res) {<br>  var post = BlogPost.new(req['blogPost']);<br>  if (post.save()) {<br>     res.flash.msg = &quot;Your Blog Post is created.&quot;;<br>     // The flash.msg is kept for the next request.  The next<br>     // request, due to the redirectToAction(), will be for the show<br>     // action method in the BlogPostController, which can then display<br>     // the flash.msg to the user.<br>     res.redirectToAction('show', post.id);<br>  }</pre></blockquote></div></div></div>

<div class=CProperty><div class=CTopic><h3 class=CTitle><a name="res.layoutName"></a>layoutName</h3><div class=CBody><p class=CParagraph>Allows the controller to defined the layout used in rendering the response.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>// The default layoutName for the ForumController will be 'main'.<br>ForumController.layoutName = 'main';<br><br>ForumController.prototype.index = function(req, res) {<br>    res.forums = Forum.findActive('all');<br>    res.layoutName = 'small_header_layout'; // Overrides the default layoutName of 'main'<br>}                                           // just for the index action method.</pre></blockquote></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="res.Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.setLocale(localeStr)"></a>setLocale (localeStr)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>setLocale : function(</td><td class=PParameter nowrap>localeStr</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Sets the locale string for the current response.</p><p class=CParagraph>View template rendering will automatically use the locale string as preferred template path suffix, such as app/views/{templatePath}{.localeStr}{.jst|est} if you use res.setLocale().&nbsp;  For example, if you call res.setLocale(&lsquo;en&rsquo;), the template renderer will first look for an app/views/invoice/show.en.est template View file.&nbsp;  If that file does not exist, the template renderer will look for an app/views/invoice/show.est template View file.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>localeStr - A string locale.</li></ul></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.getLocale"></a>getLocale ()</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>getLocale : function()</td></tr></table></blockquote><p class=CParagraph>Returns the locale string for the current response.</p><h4 class=CHeading>Returns</h4><p class=CParagraph>A string locale.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.t(str,defaultResult)"></a>t (str, defaultResult)</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>t : function(</td><td class=PParameter nowrap>str,</td></tr><tr><td></td><td class=PParameter nowrap>defaultResult</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Translate a static string based on the current response locale.</p><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>str - A string to translate.</li><li>defaultResult - An optional string result value.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>A string, either translated.&nbsp; Or, returns the defaultResult if no translation is available.&nbsp; If defaultResult is not provided, returns the original str parameter.</p><h4 class=CHeading>See</h4><p class=CParagraph>setLocale() and getLocale()</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.tChoices(arr)"></a>tChoices (arr)</h3><div class=CBody><p class=CParagraph>Translate an array of choice strings that is usually passed to the res.select() function.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>&lt;%= select('customer', 'gender', tChoices(['male', 'female'])) %&gt; &lt;br/&gt;<br>&lt;%= select('customer', 'gender', tChoices([['Guy', 'male'], ['Gal', 'female']])) %&gt; &lt;br/&gt;</pre></blockquote><h4 class=CHeading>Parameters</h4><ul class=CBulletList><li>arr - An array of strings or array of arrays, as passed to the res.select() function.</li></ul><h4 class=CHeading>Returns</h4><p class=CParagraph>A copied, translated arr.</p><h4 class=CHeading>See</h4><p class=CParagraph>select() and setLocale() and getLocale()</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.localDateString(date,withTime)"></a>localDateString (date, withTime)</h3><div class=CBody><p class=CParagraph>Similar to TrimPath.junctionUtil.toLocalDateString(), formats a Date as either &lsquo;YYYY/MM/DD&rsquo; or &lsquo;YYYY/MM/DD hh:mm:ss&rsquo;.&nbsp; The Date information is returned in local timezone.&nbsp; The returned string is also parsable by the JavaScript Data object constructor.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Invoice Creation: &lt;%= localDateString(invoice.created_at) %&gt;</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>date</td><td class=CDLDescription>A Date object or a String that&rsquo;s parsed with TrimPath.junctionUtil.parseDateString().&nbsp; If null, the function returns the empty string (&ldquo;&rdquo;).</td></tr><tr><td class=CDLEntry>withTime</td><td class=CDLDescription>A boolean, true to add hh:mm:ss to the return value.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>A string, suitable for display or sorting.&nbsp; Or, the empty string (&ldquo;&rdquo;) if there&rsquo;s a date parsing error.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="res.utcDateString(date,withTime)"></a>utcDateString (date, withTime)</h3><div class=CBody><p class=CParagraph>Similar to TrimPath.junctionUtil.toUTCDateString(), formats a Date as either &lsquo;YYYY/MM/DD&rsquo; or &lsquo;YYYY/MM/DD hh:mm:ss&rsquo;.&nbsp; The Date information is returned in UTC timezone.&nbsp; The returned string is also parsable by the JavaScript Data object constructor.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Invoice Creation: &lt;%= utcDateString(invoice.created_at) %&gt;</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>date</td><td class=CDLDescription>A Date object or a String that&rsquo;s parsed with TrimPath.junctionUtil.parseDateString().&nbsp; If null, the function returns the empty string (&ldquo;&rdquo;).</td></tr><tr><td class=CDLEntry>withTime</td><td class=CDLDescription>A boolean, true to add hh:mm:ss to the return value.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>A string, suitable for display or sorting.&nbsp; Or, the empty string (&ldquo;&rdquo;) if there&rsquo;s a date parsing error.</p></div></div></div>

<div class=CClass><div class=CTopic><h2 class=CTitle><a name="ModelErrors"></a>ModelErrors</h2><div class=CBody><p class=CParagraph>A ModelErrors object manages the validation error messages for a Model instance.</p><p class=CParagraph>Every instance of a Model has an associated ModelErrors instance, which you can retrieve by calling modelInstance.errors().</p><p class=CParagraph>Any error messages that were generated during validation of the modelInstance are stored into the modelInstance.errors() object.&nbsp; These validaton error messages are useful for display to the user.</p><p class=CParagraph>In other words, any validation error messages that were generated during modelInstance.save() or during modelInstance.is_valid() will be accessible from the ModelErrors object that&rsquo;s returned by modelInstance.errors().</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var product = Product.findActive(42); // Returns an instance of the Product Model.<br>product.price = -100;<br>product.is_valid();            // product.is_valid() returns false due to incorrect price.<br>var errors = product.errors(); // The errors object is an instance of the ModelErrors class and<br>                               // stores the error messages generated during execution of is_valid().</pre></blockquote><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr><td class=SEntrySize><div class=SGroup><div class=SEntry><a href="#ModelErrors.Functions" >Functions</a></div></div></td><td class=SDescriptionSize><div class=SGroup><div class=SDescription></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.add" id=link40 onMouseOver="ShowTip(event, 'tt16', 'link40')" onMouseOut="HideTip('tt16')">add</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds an error message that&rsquo;s associated with a named property or field.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.addToBase" >addToBase</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the add_to_base() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.add_to_base" id=link41 onMouseOver="ShowTip(event, 'tt17', 'link41')" onMouseOut="HideTip('tt17')">add_to_base</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Adds an error message assocated with the entire modelInstance.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.on" id=link42 onMouseOver="ShowTip(event, 'tt18', 'link42')" onMouseOut="HideTip('tt18')">on</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns the error messages associated with a particular property or field of a model instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.onBase" >onBase</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the on_base() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.on_base" id=link43 onMouseOver="ShowTip(event, 'tt19', 'link43')" onMouseOut="HideTip('tt19')">on_base</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns the error messages that were associated with the entire model instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.clear" id=link44 onMouseOver="ShowTip(event, 'tt20', 'link44')" onMouseOut="HideTip('tt20')">clear</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Removes all the error messages held by this ModelErrors instance.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.isInvalid" >isInvalid</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the is_invalid() method.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.is_invalid" id=link45 onMouseOver="ShowTip(event, 'tt21', 'link45')" onMouseOut="HideTip('tt21')">is_invalid</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns whether there are error messages associated with a particular property or field of a model instance.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.count" id=link46 onMouseOver="ShowTip(event, 'tt22', 'link46')" onMouseOut="HideTip('tt22')">count</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns the number of error messages stored in the ModelErrors instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.isEmpty" >isEmpty</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the is_empty() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.is_empty" id=link47 onMouseOver="ShowTip(event, 'tt23', 'link47')" onMouseOut="HideTip('tt23')">is_empty</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns whether there are any error messages stored in the ModelErrors instance. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.invalidAttributes" >invalidAttributes</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the invalid_attributes() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.invalid_attributes" id=link48 onMouseOver="ShowTip(event, 'tt24', 'link48')" onMouseOut="HideTip('tt24')">invalid_attributes</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns the names of properties/fields that have validation errors.</div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.fullMessagesOn" >fullMessagesOn</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the full_messages_on() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.full_messages_on" id=link49 onMouseOver="ShowTip(event, 'tt25', 'link49')" onMouseOut="HideTip('tt25')">full_messages_on</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns an Array of error message strings associated with a given attrName. </div></div></div></td></tr><tr class=SMarked><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.fullMessages" >fullMessages</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>An alias for the full_messages() method.</div></div></div></td></tr><tr><td><div class=SFunction><div class=SEntry><div class=SIndent1><a href="#ModelErrors.full_messages" id=link50 onMouseOver="ShowTip(event, 'tt26', 'link50')" onMouseOut="HideTip('tt26')">full_messages</a></div></div></div></td><td><div class=SFunction><div class=SDescription><div class=SIndent1>Returns an Array of all error message strings. </div></div></div></td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class=CGroup><div class=CTopic><h3 class=CTitle><a name="ModelErrors.Functions"></a>Functions</h3></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.add"></a>add</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.add = function(</td><td class=PParameter nowrap>attrName,</td></tr><tr><td></td><td class=PParameter nowrap>msg</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Adds an error message that&rsquo;s associated with a named property or field.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Product.prototype.validate = function() {<br>    // We implement the validate() method by checking the Product.price...<br>    if (this.price &lt; 0)<br>        this.errors().add('price', 'cannot have negative price values');<br>}</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string name of the property or field of the Model that has an error.</td></tr><tr><td class=CDLEntry>msg</td><td class=CDLDescription>An optional string error message that should be readable or sensible in a concatenated sentence of (attrname + spaceChar + msg).&nbsp; For example, if attrName is &lsquo;price&rsquo;, then &lsquo;cannot be less than zero&rsquo; makes a sensible msg, since the concatenated string value would be &lsquo;price cannot be less than zero&rsquo;.&nbsp; The msg defaults to the string &lsquo;is invalid&rsquo;.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>void</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.addToBase"></a>addToBase</h3><div class=CBody><p class=CParagraph>An alias for the add_to_base() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.add_to_base"></a>add_to_base</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.add_to_base = function(</td><td class=PParameter nowrap>msg</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Adds an error message assocated with the entire modelInstance.</p><p class=CParagraph>Unlike the add() method, the add_to_base() method associates a validation error message with the entire Model instance.&nbsp; This is appropriate when the validation error covers more than one Model property or field.&nbsp;  Also, this is useful for when there are validation errors that cover more than one Model, such as in parent-child relationships (e.g., when an Order must have at least one OrderLine).</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>Employee.prototype.validate = function() {<br>    if (this.start_date &gt; this.end_date)<br>        this.errors().add_to_base('start and end dates are invalid');<br>}</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>msg</td><td class=CDLDescription>An error message string that will be associated with the entire Model instance, rather than to a particular property or field of the Model instance.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>void</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.on"></a>on</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.on = function(</td><td class=PParameter nowrap>attrName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Returns the error messages associated with a particular property or field of a model instance.&nbsp;  That is, modelInstance.errors().on(attrName) returns all the error messages that were stored by earlier calls to modelInstance.errors().add(attrName, errorMessage);</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>for (var errs = product.errors().on('price') || [],<br>         i = 0; i &lt; errs.length; i++)<br>    displayToUser('price', errs[i]);</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string name of a property or field.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of error message strings, or null.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.onBase"></a>onBase</h3><div class=CBody><p class=CParagraph>An alias for the on_base() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.on_base"></a>on_base</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.on_base = function()</td></tr></table></blockquote><p class=CParagraph>Returns the error messages that were associated with the entire model instance.&nbsp;  That is, the modelInstance.errors().on_base() method returns all the error messages that were stored by earlier calls to modelInstance.errors().add_to_base(errorMessage);</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>for (var errs = employee.errors().on_base() || [],<br>         i = 0; i &lt; errs.length; i++)<br>    displayToUser(errs[i]);</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of error message strings, or null.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.clear"></a>clear</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.clear = function()</td></tr></table></blockquote><p class=CParagraph>Removes all the error messages held by this ModelErrors instance.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>product.errors().clear();<br>// After calling clear(), the errors() will be empty...<br>product.errors().count();            // == 0<br>product.errors().isEmpty();          // == true<br>product.errors().isInvalid('price'); // == false<br>product.errors().on('price');        // == null<br>product.errors().onBase();           // == null</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>void</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.isInvalid"></a>isInvalid</h3><div class=CBody><p class=CParagraph>An alias for the is_invalid() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.is_invalid"></a>is_invalid</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.is_invalid = function(</td><td class=PParameter nowrap>attrName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Returns whether there are error messages associated with a particular property or field of a model instance.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>if (product.errors().is_invalid('price'))<br>    displayToUser(product.errors().fullMessagesOn('price'));</pre></blockquote><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string name of a property or field.</td></tr></table><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.count"></a>count</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.count = function()</td></tr></table></blockquote><p class=CParagraph>Returns the number of error messages stored in the ModelErrors instance.&nbsp; The error messages (and hence the count) can be cleared by calling the clear() method.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>if (product.errors().count() &gt; 0)<br>    displayToUser(product.errors().fullMessages().join('&lt;hr/&gt;'));</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An integer.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.isEmpty"></a>isEmpty</h3><div class=CBody><p class=CParagraph>An alias for the is_empty() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.is_empty"></a>is_empty</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.is_empty = function()</td></tr></table></blockquote><p class=CParagraph>Returns whether there are any error messages stored in the ModelErrors instance.&nbsp;  That is, returns true if count() == 0.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>if (!product.errors().is_empty())<br>    displayToUser(product.errors().fullMessages().join('&lt;hr/&gt;'));</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>A boolean.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.invalidAttributes"></a>invalidAttributes</h3><div class=CBody><p class=CParagraph>An alias for the invalid_attributes() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.invalid_attributes"></a>invalid_attributes</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.invalid_attributes = function()</td></tr></table></blockquote><p class=CParagraph>Returns the names of properties/fields that have validation errors.</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>for (var columnNamesWithErrors = product.errors().invalid_attributes(),<br>         i = 0; i &lt; columnNamesWithErrors.length; i++)<br>  displayToUser(product.errors().fullMessagesOn(columnNamesWithErrors[i]);</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of property/field/column names.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.fullMessagesOn"></a>fullMessagesOn</h3><div class=CBody><p class=CParagraph>An alias for the full_messages_on() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.full_messages_on"></a>full_messages_on</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.full_messages_on = function(</td><td class=PParameter nowrap>attrName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote><p class=CParagraph>Returns an Array of error message strings associated with a given attrName.&nbsp;  The returned strings are concatenated, like (attrName + spaceChar + msg).</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>attrName</td><td class=CDLDescription>A string name of a property or field.</td></tr></table><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var priceErrors = product.errors().full_messages_on('price');</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of error message strings.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.fullMessages"></a>fullMessages</h3><div class=CBody><p class=CParagraph>An alias for the full_messages() method.</p></div></div></div>

<div class=CFunction><div class=CTopic><h3 class=CTitle><a name="ModelErrors.full_messages"></a>full_messages</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.full_messages = function()</td></tr></table></blockquote><p class=CParagraph>Returns an Array of all error message strings.&nbsp; All error message strings that were added using add() or add_to_base() will be returned by full_messages().</p><h4 class=CHeading>Example</h4><blockquote><pre class=CCode>var validationErrors = product.errors().full_messages();<br>displayToUser('&lt;p&gt;' + validationErrors.join('&lt;/p&gt;&lt;p&gt;') + '&lt;/p&gt;');</pre></blockquote><h4 class=CHeading>Returns</h4><p class=CParagraph>An Array of error message strings.</p></div></div></div>

</td>

</tr></table><div class=Footer><!--START_ND_FOOTER-->Generated by <a href="http://www.naturaldocs.org">Natural Docs</a><!--END_ND_FOOTER--></div>
<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>syncUp : function()</td></tr></table></blockquote>Requests an asynchronous synchronization of the local database with the server database. </div></div><div class=CToolTip id="tt2"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>isOnline : function()</td></tr></table></blockquote>Returns whether a client-side Junction environment is online (has connectivity to a server). </div></div><div class=CToolTip id="tt3"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>dbExecute : function(</td><td class=PParameter nowrap>sql,</td></tr><tr><td></td><td class=PParameter nowrap>optParams</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Executes a SQL query against the local application database. </div></div><div class=CToolTip id="tt4"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>scaffold : function(</td><td class=PParameter nowrap>controllerFunc,</td></tr><tr><td></td><td class=PParameter nowrap>modelName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Provides some simple Controller action methods for a given Model for increased developer productivity.</div></div><div class=CToolTip id="tt5"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>modelInfo.func.find = function(</td><td class=PParameter nowrap>id,</td></tr><tr><td></td><td class=PParameter nowrap>params</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Queries the database for records of Model. </div></div><div class=CToolTip id="tt6"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.deactivate = function()</td></tr></table></blockquote>Sets the active column of the model instance to 0. </div></div><div class=CToolTip id="tt7"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.destroy = function()</td></tr></table></blockquote>Deletes the model record from the local RDBMS. </div></div><div class=CToolTip id="tt8"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.save = function()</td></tr></table></blockquote>Saves a new or updated Model instance to the RDBMS.</div></div><div class=CToolTip id="tt9"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>modelInfo.func.prototype.errors = function()</td></tr></table></blockquote>Returns the ModelErrors object that holds validation error information.</div></div><div class=CToolTip id="tt10"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>modelInfo.func.prototype.setConventionalAttributes = function(</td><td class=PParameter nowrap>skipVersion</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Sets the convention-over-configuration field attributes of the Model instance. </div></div><div class=CToolTip id="tt11"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ddl.column = function()</td></tr></table></blockquote>A syntatic sugar helper function that creates a column definition array. </div></div><div class=CToolTip id="tt12"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>render : function(</td><td class=PParameter nowrap>templateName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Render a template.</div></div><div class=CToolTip id="tt13"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>setLocale : function(</td><td class=PParameter nowrap>localeStr</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Sets the locale string for the current response.</div></div><div class=CToolTip id="tt14"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>getLocale : function()</td></tr></table></blockquote>Returns the locale string for the current response.</div></div><div class=CToolTip id="tt15"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>t : function(</td><td class=PParameter nowrap>str,</td></tr><tr><td></td><td class=PParameter nowrap>defaultResult</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Translate a static string based on the current response locale.</div></div><div class=CToolTip id="tt16"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.add = function(</td><td class=PParameter nowrap>attrName,</td></tr><tr><td></td><td class=PParameter nowrap>msg</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Adds an error message that&rsquo;s associated with a named property or field.</div></div><div class=CToolTip id="tt17"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.add_to_base = function(</td><td class=PParameter nowrap>msg</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Adds an error message assocated with the entire modelInstance.</div></div><div class=CToolTip id="tt18"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.on = function(</td><td class=PParameter nowrap>attrName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Returns the error messages associated with a particular property or field of a model instance. </div></div><div class=CToolTip id="tt19"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.on_base = function()</td></tr></table></blockquote>Returns the error messages that were associated with the entire model instance. </div></div><div class=CToolTip id="tt20"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.clear = function()</td></tr></table></blockquote>Removes all the error messages held by this ModelErrors instance.</div></div><div class=CToolTip id="tt21"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.is_invalid = function(</td><td class=PParameter nowrap>attrName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Returns whether there are error messages associated with a particular property or field of a model instance.</div></div><div class=CToolTip id="tt22"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.count = function()</td></tr></table></blockquote>Returns the number of error messages stored in the ModelErrors instance. </div></div><div class=CToolTip id="tt23"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.is_empty = function()</td></tr></table></blockquote>Returns whether there are any error messages stored in the ModelErrors instance. </div></div><div class=CToolTip id="tt24"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.invalid_attributes = function()</td></tr></table></blockquote>Returns the names of properties/fields that have validation errors.</div></div><div class=CToolTip id="tt25"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class=PBeforeParameters nowrap>ModelErrors.prototype.full_messages_on = function(</td><td class=PParameter nowrap>attrName</td><td class=PAfterParameters nowrap>)</td></tr></table></td></tr></table></blockquote>Returns an Array of error message strings associated with a given attrName. </div></div><div class=CToolTip id="tt26"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class=Prototype><tr><td>ModelErrors.prototype.full_messages = function()</td></tr></table></blockquote>Returns an Array of all error message strings. </div></div><div class=CToolTip id="tt27"><div class=CClass>A Model class represents and manages a tables in a database. </div></div><div class=CToolTip id="tt28"><div class=CSection>The metadata for a Model defines the object-relational mapping between the JavaScript Model object and a database table in the RDBMS. </div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>