<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><title>Runtime Environments</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script></head><body class=UnframedPage onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.35 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->

<table border=0 cellspacing=0 cellpadding=0 width=100%><tr><td class=MenuSection valign=top><!--START_ND_MENU--><div class=MEntry><div class=MFile><a href="junction_doc_about-txt.html">About TrimPath Junction</a></div></div><div class=MEntry><div class=MFile id=MSelected>Runtime Environments</div></div><div class=MEntry><div class=MFile><a href="junction_doc_run_browser-txt.html">Runtime In The Browser</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_run_server-txt.html">Runtime On The Server</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_sync-txt.html">Synchronization</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_translation-txt.html">Translations</a></div></div><div class=MEntry><div class=MFile><a href="junction-js.html">TrimPath.<span class=HB> </span>junction</a></div></div><div class=MEntry><div class=MFile><a href="junctionClient-js.html">TrimPath.<span class=HB> </span>junctionClient</a></div></div><div class=MEntry><div class=MFile><a href="junctionHelpers-js.html">TrimPath.<span class=HB> </span>junctionHelpers</a></div></div><div class=MEntry><div class=MFile><a href="junctionUtil-js.html">TrimPath.<span class=HB> </span>junctionUtil</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_controller-txt.html">web-MVC Controller</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_model-txt.html">web-MVC Model</a></div></div><div class=MEntry><div class=MFile><a href="junction_doc_view-txt.html">web-MVC View</a></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Index</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MIndex><a href="../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Classes.html">Classes</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Variables.html">Variables</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Properties.html">Properties</a></div></div></div></div></div><!--END_ND_MENU--></td>

<td class=ContentSection valign=top><div class=CGeneric id=MainTopic><div class=CTopic><h1 class=CTitle><a name="Runtime_Environments"></a>Runtime Environments</h1><div class=CBody><p class=CParagraph>You have several different options for deploying a Junction-based web application, depending on where you want your web application code and database to run...</p><ul class=CBulletList><li>Run your Junction application in a web application server.</li><li>Run your Junction application in a web browser client.</li><li>Run your Junction application in both places.</li></ul><h4 class=CHeading>Run Your Junction Application In A Web Application Server</h4><p class=CParagraph>This type of deployment is similar to how you use other server-side web application frameworks, such as Ruby on Rails, Django, or Java Servlets/JSP/Hibernate.</p><p class=CParagraph>Here is a simplified picture that shows how a web application server is responsible for dynamically generating HTTP responses from requests from web clients.&nbsp;  The web application server executes the web application&rsquo;s Controller, Model and View code on the server-side.&nbsp; The Model code provides object-relational access to data from a relational database management server (RDBMS).</p><blockquote><pre class=CCode>client-side:                         server-side:<br>+-------------+                      +----------------+<br>| web browser |                      | web app server |<br>|             |                      |                | +-----------+<br>| &lt;a href&gt;    | ==&gt; HTTP request ==&gt; | Controller     | |           |<br>|             |                      |        Model &lt;=====&gt; RDBMS   |<br>|             | &lt;== HTTP response == | View           | |           |<br>+-------------+                      +----------------+ +-----------+</pre></blockquote><p class=CParagraph>Junction&rsquo;s web-application server is implemented using the open-source Rhino JavaScript scripting engine.</p><p class=CParagraph>In the Junction world, the Model and Controller application logic are coded in JavaScript.&nbsp;  View templates are coded using JavaScript Template (JST) markup tags (or by using EcmaScript Template (EST) markup tags, if you prefer).</p><p class=CParagraph>The request and response between the client and server may be for a full dynamically generated HTML result page, such as when a user clicks on a simple HTML link (&lt;a href=&rdquo;...&rdquo;&gt;).&nbsp; Or, the request/response may be for an Ajax-driven partial page fragment or for an Ajax-driven XML/JSON data result.</p><p class=CParagraph>One issue with running Junction on the server-side is that users need to be always fully connected to use the web application.&nbsp;  This precludes mobile clients or clients who have a slow, intermittent or unavailable network connection (think of iPhone).&nbsp;  The next deployment scenario discussed provides a partial solution, allowing users to use their web application even when offline.</p><h4 class=CHeading>Run Your Junction Application In A Web Browser Client</h4><p class=CParagraph>Alternatively, you can have your Junction-based application running entirely in the web browser client.</p><blockquote><pre class=CCode>client-side:                                      server-side:<br>+---------------------------------------------+   +----------------+<br>| web browser                                 |   | web app server |<br>|                                             |   +----------------+<br>| &lt;a href&gt;    +~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~+<br>|             '  +---------------+ +--------+ |<br>|  request ====&gt; | Controller    | |        | |<br>|             '  |        Model &lt;===&gt; RDBMS | |<br>|  response &lt;=== | View          | |        | |<br>|             '  +---------------+ +--------+ |<br>|             '   junctionClient              |<br>+-------------+-------------------------------+</pre></blockquote><p class=CParagraph>In this deployment scenario, the same Model-View-Controller code as from the previous server-side case is instead deployed into a web page and downloaded into the web browser.&nbsp; So, all the Model-View-Controller application code executes completely in the web browser on each request (it&rsquo;s all just JavaScript, after all).&nbsp; We note again that it&rsquo;s the <u>same</u> application code in both server-side and client-side runtime scenarios.&nbsp;  For example, your View template code still gets processed and rendered the same way, whether running on the server or on the client.</p><p class=CParagraph>Junction API&rsquo;s and conventions are designed so that a single application codebase should be able to run either on the server-side or on the client-side without any conditional environment checking logic in your application code.&nbsp;  You&rsquo;ll need to follow simple rules, though, such as not accessing &lsquo;document.body&rsquo; or calling &lsquo;alert(&ldquo;Hi&rdquo;)&rsquo; in your Models, Views or Controllers, because such API&rsquo;s are not available when executing in a server-side environment.</p><p class=CParagraph>In the web browser, a junctionClient runtime component mediates between processing requests from the user and displaying responses back in the web browser page.&nbsp;  The junctionClient runtime component is itself written in JavaScript.</p><p class=CParagraph>In this environment, HTML links and controls that the user clicks on in the page require an onclick/onsubmit event handler that invokes the junctionClient runtime...</p><blockquote><pre class=CCode>&lt;a href=&quot;...&quot;<br>   onclick=&quot;return TrimPath.junctionClient.get(...request info...)&quot;&gt;<br>   Show All Products<br>&lt;/a&gt;<br><br>&lt;form action=&quot;...&quot;<br>      onsubmit=&quot;return TrimPath.junctionClient.postForm(...)&quot;&gt;<br>  ...<br>&lt;/form&gt;</pre></blockquote><p class=CParagraph>Because the junctionClient runtime is invoked as part of the event handler, it will process the request locally, using the client-side MVC application code and local RDBMS.&nbsp;  It is as if a mini-web-application-server was running right in your browser.&nbsp;  This often provides a marked improvement in UI responsiveness since there is no communication with any remote server and thus avoids any hiccups or failures due to slow, intermittent or unavailable network connectivity.&nbsp;  (Think of Safari on the iPhone on a weak network connection.)&nbsp;  Junction can also additionally utilize the LocalServer offline capabilities of Google Gears, if available, allowing the application to be loaded, started and run without any network connection.</p><p class=CParagraph>The RDBMS in this deployment scenario is a client-side, browser-local RDBMS.&nbsp;  Junction will automatically use Google Gears RDBMS facilities, if installed and available.&nbsp;  Or, Junction will default to using a simple memory-only, non-persistent RDBMS that should be treated like a local data cache.</p><p class=CParagraph>The server-side in this deployment scenario may be very simple -- conceptually just a server that publishes the static resources, MVC code, and libraries that comprise the application.&nbsp;  The RDBMS, after all, is in the client.&nbsp;  The Junction web application server does, however, also provide for useful application code updating and schema migration services in this client-heavy deployment scenario.&nbsp; This scenario, too, provides a good story for server-side scalability, because the server is doing very little work.</p><p class=CParagraph>However, the preeminent issue with this deployment scenario is that <u>the user&rsquo;s data is not shared</u>.&nbsp;  Even with Google Gears RDBMS installed in the user&rsquo;s web browser to allow for persistent data, any data created by a user is kept only on their own computer.&nbsp; Some folks might see this as a feature beneficial to their privacy.&nbsp; Indeed, an interesting set of personal productivity or other applications might be amenable to this client-side, unshared-data deployment scenario (e.g., a personal financial asset tracker; a personal todo-list manager).</p><p class=CParagraph>Many other applications or business use cases, though, require users to share data (e.g., team productivity applications).&nbsp;  While the client-side, unshared-data scenario might be interesting as a first step in a menu of application service-level plans (e.g., Personal Edition, $5/month), especially since it consumes so few server resources, eventually providing for team shared data is required (e.g., Basic Team Edition, $20/month/user).</p><p class=CParagraph>The next deployment scenario provides a solution to allowing for offline clients, responsive UI&rsquo;s and for shared team data...</p><h4 class=CHeading>Run Your Junction Application In Both Client-Side And-Server Side</h4><blockquote><pre class=CCode>client-side:                            server-side:<br>+-----------------------------------+   +------------+<br>| web browser                       |   | web app    |<br>|                                   |   | server     |<br>|                      B.           |   |            | +---------+<br>|                      request =======&gt; | Controller | |  I.     |<br>|                                   |   |    Model &lt;====&gt; RDBMS  |<br>|                      response &lt;====== | View      /\ |         |<br>|                                   |   +--------++-|| +---------+<br>|                                   |            || ||<br>|             +~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~+            || ||<br>|  A.         '  +------+ +-------+ |&lt;=(code sync)+ ||<br>|  request ====&gt; | C    | | II.   | |               ||<br>|             '  |  M &lt;===&gt; RDBMS |&lt;=-=(data sync)=-=+<br>|  response &lt;=== | V    | |       | |<br>|             '  +------+ +-------+ |<br>|             '   junctionClient    |<br>+-------------+---------------------+</pre></blockquote><p class=CParagraph>In this runtime scenario, the (same) application codebase is deployed to both the web application server and to the web browser client.</p><p class=CParagraph>However, the &lsquo;source of truth&rsquo; for data is the server-side RDBMS (I.), which may hold large datasets of records.&nbsp;  The client-side RDBMS (II.), in contrast, is treated as a local cached subset of records.</p><p class=CParagraph>The application normally serves requests off the local, client-side RDBMS cache as much as possible, going through the fast in-browser, mini-web-app-server Model-View-Controller processing cycle (A.).</p><p class=CParagraph>As the user creates, deletes and updates records in his or her local RDBMS cache, Junction also automatically provides record-level data synchronization (data sync) between the local RDBMS cache and the server-side RDBMS, with the Junction web application server handling the synchronization messages on the server side.</p><p class=CParagraph>The local RDBMS cache can even have records created/updated/deleted while the user was offline, eventually synchronizing data when the client restores network connectivity.&nbsp;  To support these offline operations, Junction tracks changes in the client-side RDBMS with special tracking columns and tables that Junction adds to the database schema.</p><p class=CParagraph>The server-side web application server can also service regular HTML page requests and AJAX requests (B.), such as in the case where the user wants to query or search the entire server-side dataset.&nbsp;  For example, in a wiki application, the user might have only a small subset of pages cached in her local RDBMS (so she can read and edit those pages while on her train commute).&nbsp;  However, when connected, she wants to query the full wiki dataset for more pages.&nbsp;  Those queries can be serviced by the web application server.</p><p class=CParagraph>A two-phased enhancement of the previous wiki example is possible.&nbsp; To handle a user query or search, the local RDBMS is first quickly queried and an initial results page is immediately displayed to the user (A.).&nbsp;  Since the local RDBMS cache query results might be incomplete, the application can call an API to also invoke an asynchronous Ajax request (B.) to the server, which is processed if the network is online.&nbsp; When a larger result set later arrives from the web application server, it can be interleaved into the search results page that had until now had only local RDBMS cache query results.&nbsp;  The end effect is a striking increase in perceived application responsiveness.</p><p class=CParagraph>In this dual client-side and server-side deployment scenario, the Junction system also automatically detects when the client-side application codebase and database schema is outdated, and update and migrate accordingly (code sync, in the diagram above).&nbsp; Since the Junction system supports a Ruby-on-Rails-like database schema migration facility, even if the client-side system has been offline for a long time, updates and migrations are easy to take care of.</p></div></div></div>

</td>

</tr></table><div class=Footer><!--START_ND_FOOTER-->Generated by <a href="http://www.naturaldocs.org">Natural Docs</a><!--END_ND_FOOTER--></div>
<!--START_ND_TOOLTIPS-->
<!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>